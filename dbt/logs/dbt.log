

============================== 2022-08-09 23:44:10.507932 | f19a59e6-bb7c-45d2-9df2-149134e0a3d2 ==============================
23:44:10.507939 [info ] [MainThread]: Running with dbt=1.1.1
23:44:10.508227 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
23:44:10.508354 [debug] [MainThread]: Tracking: tracking
23:44:10.529974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90fae2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90fae23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90fae22b0>]}
23:44:10.595135 [debug] [MainThread]: Executing "git --help"
23:44:10.603659 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:44:10.604260 [debug] [MainThread]: STDERR: "b''"
23:44:10.609695 [debug] [MainThread]: Acquiring new postgres connection "debug"
23:44:10.610642 [debug] [MainThread]: Using postgres connection "debug"
23:44:10.610950 [debug] [MainThread]: On debug: select 1 as id
23:44:10.611206 [debug] [MainThread]: Opening a new connection, currently in state init
23:44:10.626379 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
23:44:10.628012 [debug] [MainThread]: On debug: Close
23:44:10.628584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90f1d80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90f1d8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90f1d8f70>]}
23:44:11.991701 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-09 23:44:22.394634 | b0ddd6c5-b2a9-475e-8401-1bc681c471ae ==============================
23:44:22.394652 [info ] [MainThread]: Running with dbt=1.1.1
23:44:22.395183 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
23:44:22.395493 [debug] [MainThread]: Tracking: tracking
23:44:22.415566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6603660ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6603660fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6603660fa0>]}
23:44:22.430127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f660367a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6603686640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6603686a60>]}


============================== 2022-08-09 23:45:10.680563 | ac92df50-65fe-48c7-89ff-a7bd96cf86ce ==============================
23:45:10.680579 [info ] [MainThread]: Running with dbt=1.1.1
23:45:10.681067 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
23:45:10.681245 [debug] [MainThread]: Tracking: tracking
23:45:10.697089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e030df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e030dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e03270a0>]}
23:45:10.706100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e0327820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e0330fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e03350d0>]}


============================== 2022-08-09 23:45:37.201208 | f0a10030-5441-47b5-bf79-42b175679038 ==============================
23:45:37.201227 [info ] [MainThread]: Running with dbt=1.1.1
23:45:37.201739 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
23:45:37.201886 [debug] [MainThread]: Tracking: tracking
23:45:37.218651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36766c8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36766c8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36766de0a0>]}
23:45:37.228867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36766de820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36766eaaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36766f70d0>]}


============================== 2022-08-09 23:47:43.201799 | d7dcc745-0b0b-4f20-89fe-9a62fba78f1b ==============================
23:47:43.201816 [info ] [MainThread]: Running with dbt=1.1.1
23:47:43.202294 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
23:47:43.202445 [debug] [MainThread]: Tracking: tracking
23:47:43.218384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc560ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc560efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc562e0a0>]}
23:47:43.227430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc562e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc5638af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc56420d0>]}


============================== 2022-08-09 23:49:34.946107 | e49479e2-b653-4776-b9b7-545c0c4008d3 ==============================
23:49:34.946123 [info ] [MainThread]: Running with dbt=1.1.1
23:49:34.946591 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
23:49:34.946735 [debug] [MainThread]: Tracking: tracking
23:49:34.962629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54c483c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54c49f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54c49f0d0>]}
23:49:34.972051 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
23:49:34.972516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e49479e2-b653-4776-b9b7-545c0c4008d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54c4a87f0>]}
23:49:34.974132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54c4b8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54c4b8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb54c4b8970>]}


============================== 2022-08-09 23:50:04.216899 | 34f1d35c-dfd7-461a-8a9c-41e11cc164a0 ==============================
23:50:04.216911 [info ] [MainThread]: Running with dbt=1.1.1
23:50:04.217388 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
23:50:04.217517 [debug] [MainThread]: Tracking: tracking
23:50:04.233091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec0416fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec042e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec042e0d0>]}
23:50:04.242650 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
23:50:04.242907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '34f1d35c-dfd7-461a-8a9c-41e11cc164a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec0438820>]}
23:50:04.244667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec043c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec043c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec043c9a0>]}


============================== 2022-08-09 23:51:12.890970 | 3f02db06-3178-4a8e-95b2-78070ccf541a ==============================
23:51:12.890986 [info ] [MainThread]: Running with dbt=1.1.1
23:51:12.891429 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
23:51:12.891562 [debug] [MainThread]: Tracking: tracking
23:51:12.907400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c0e7bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c0e7be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c0e96040>]}
23:51:12.918250 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
23:51:12.918516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f02db06-3178-4a8e-95b2-78070ccf541a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c0ea1f70>]}
23:51:12.920670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c0eae040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c0eae7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c0eae910>]}


============================== 2022-08-09 23:52:12.349379 | a8856d73-dbcd-4db0-b4ed-e8b12ae952cf ==============================
23:52:12.349396 [info ] [MainThread]: Running with dbt=1.1.1
23:52:12.349934 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
23:52:12.350102 [debug] [MainThread]: Tracking: tracking
23:52:12.365903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c5729fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c57420a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c57420d0>]}
23:52:12.375611 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
23:52:12.375954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a8856d73-dbcd-4db0-b4ed-e8b12ae952cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c574b7f0>]}
23:52:12.377546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c574f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c574fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c574f820>]}


============================== 2022-08-09 23:52:31.062668 | 90d82d19-d6c2-45ab-b93c-2fd0f50033a7 ==============================
23:52:31.062684 [info ] [MainThread]: Running with dbt=1.1.1
23:52:31.063114 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
23:52:31.063252 [debug] [MainThread]: Tracking: tracking
23:52:31.079170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ff17cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ff17cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ff1950a0>]}
23:52:31.088440 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
23:52:31.088841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90d82d19-d6c2-45ab-b93c-2fd0f50033a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ff19e7c0>]}
23:52:31.090400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ff1a40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ff1a4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ff1a4940>]}


============================== 2022-08-09 23:53:12.974616 | dba001fe-d07b-4e0a-ae60-cb8799ace4ca ==============================
23:53:12.974633 [info ] [MainThread]: Running with dbt=1.1.1
23:53:12.975086 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
23:53:12.975236 [debug] [MainThread]: Tracking: tracking
23:53:12.990962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311f798ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311f798fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311f798fa0>]}
23:53:13.000246 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
23:53:13.000488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dba001fe-d07b-4e0a-ae60-cb8799ace4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311f7bffd0>]}
23:53:13.013179 [debug] [MainThread]: Parsing macros/relations.sql
23:53:13.014602 [debug] [MainThread]: Parsing macros/adapters.sql
23:53:13.028052 [debug] [MainThread]: Parsing macros/catalog.sql
23:53:13.029538 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
23:53:13.030693 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
23:53:13.032216 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
23:53:13.033218 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
23:53:13.034273 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
23:53:13.034828 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
23:53:13.035312 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
23:53:13.036349 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
23:53:13.036992 [debug] [MainThread]: Parsing macros/materializations/configs.sql
23:53:13.038563 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
23:53:13.040992 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
23:53:13.050943 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
23:53:13.054644 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
23:53:13.055640 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
23:53:13.065013 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
23:53:13.070986 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
23:53:13.081057 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
23:53:13.083730 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
23:53:13.085436 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
23:53:13.090190 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
23:53:13.094507 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
23:53:13.095943 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
23:53:13.096750 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
23:53:13.098408 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
23:53:13.104865 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
23:53:13.114772 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
23:53:13.115827 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
23:53:13.123457 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
23:53:13.124554 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
23:53:13.125730 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
23:53:13.128503 [debug] [MainThread]: Parsing macros/etc/datetime.sql
23:53:13.133415 [debug] [MainThread]: Parsing macros/etc/statement.sql
23:53:13.136140 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
23:53:13.140508 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
23:53:13.142479 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
23:53:13.144312 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
23:53:13.147030 [debug] [MainThread]: Parsing macros/adapters/columns.sql
23:53:13.153964 [debug] [MainThread]: Parsing macros/adapters/schema.sql
23:53:13.155431 [debug] [MainThread]: Parsing macros/adapters/relation.sql
23:53:13.161182 [debug] [MainThread]: Parsing tests/generic/builtin.sql
23:53:13.274445 [debug] [MainThread]: 1603: static parser failed on advert/merger_model.sql
23:53:13.277347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311f7b4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311f73ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311f73d280>]}


============================== 2022-08-09 23:54:04.078324 | db508b51-ca09-4b87-8e8d-f42429149f32 ==============================
23:54:04.078339 [info ] [MainThread]: Running with dbt=1.1.1
23:54:04.078867 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
23:54:04.079037 [debug] [MainThread]: Tracking: tracking
23:54:04.094826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68ff0cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68ff0cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68ff0cfd0>]}
23:54:04.104492 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
23:54:04.104726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'db508b51-ca09-4b87-8e8d-f42429149f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68ff32a60>]}
23:54:04.109734 [debug] [MainThread]: Parsing macros/relations.sql
23:54:04.111142 [debug] [MainThread]: Parsing macros/adapters.sql
23:54:04.124688 [debug] [MainThread]: Parsing macros/catalog.sql
23:54:04.126180 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
23:54:04.127326 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
23:54:04.128963 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
23:54:04.130129 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
23:54:04.131209 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
23:54:04.131796 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
23:54:04.132339 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
23:54:04.133381 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
23:54:04.134006 [debug] [MainThread]: Parsing macros/materializations/configs.sql
23:54:04.135602 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
23:54:04.138639 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
23:54:04.148634 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
23:54:04.152256 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
23:54:04.153265 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
23:54:04.162427 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
23:54:04.168278 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
23:54:04.177959 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
23:54:04.180661 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
23:54:04.182435 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
23:54:04.187259 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
23:54:04.191634 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
23:54:04.193099 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
23:54:04.193983 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
23:54:04.195873 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
23:54:04.202378 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
23:54:04.212157 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
23:54:04.213319 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
23:54:04.220990 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
23:54:04.222193 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
23:54:04.223383 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
23:54:04.226421 [debug] [MainThread]: Parsing macros/etc/datetime.sql
23:54:04.231910 [debug] [MainThread]: Parsing macros/etc/statement.sql
23:54:04.234676 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
23:54:04.239095 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
23:54:04.240893 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
23:54:04.242755 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
23:54:04.245643 [debug] [MainThread]: Parsing macros/adapters/columns.sql
23:54:04.251375 [debug] [MainThread]: Parsing macros/adapters/schema.sql
23:54:04.252811 [debug] [MainThread]: Parsing macros/adapters/relation.sql
23:54:04.258426 [debug] [MainThread]: Parsing tests/generic/builtin.sql
23:54:04.372969 [debug] [MainThread]: 1699: static parser successfully parsed advert/merger_model.sql
23:54:04.395253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68ee54280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68ee44ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68ee44c10>]}


============================== 2022-08-09 23:54:26.478111 | 2329e807-39b6-4dfc-84d0-d59f2c03facc ==============================
23:54:26.478138 [info ] [MainThread]: Running with dbt=1.1.1
23:54:26.478600 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
23:54:26.478775 [debug] [MainThread]: Tracking: tracking
23:54:26.494937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7169021f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7169021fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716903c0a0>]}
23:54:26.504285 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
23:54:26.504513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2329e807-39b6-4dfc-84d0-d59f2c03facc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71690477c0>]}
23:54:26.509689 [debug] [MainThread]: Parsing macros/relations.sql
23:54:26.511240 [debug] [MainThread]: Parsing macros/adapters.sql
23:54:26.524722 [debug] [MainThread]: Parsing macros/catalog.sql
23:54:26.526100 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
23:54:26.527224 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
23:54:26.528844 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
23:54:26.529910 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
23:54:26.531197 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
23:54:26.531764 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
23:54:26.532233 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
23:54:26.533304 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
23:54:26.533950 [debug] [MainThread]: Parsing macros/materializations/configs.sql
23:54:26.535580 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
23:54:26.538269 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
23:54:26.548919 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
23:54:26.552654 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
23:54:26.553609 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
23:54:26.562586 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
23:54:26.568492 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
23:54:26.578076 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
23:54:26.580840 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
23:54:26.582597 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
23:54:26.587187 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
23:54:26.591312 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
23:54:26.592696 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
23:54:26.593521 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
23:54:26.595305 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
23:54:26.601568 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
23:54:26.611093 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
23:54:26.612237 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
23:54:26.619793 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
23:54:26.620962 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
23:54:26.622051 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
23:54:26.624798 [debug] [MainThread]: Parsing macros/etc/datetime.sql
23:54:26.629916 [debug] [MainThread]: Parsing macros/etc/statement.sql
23:54:26.632648 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
23:54:26.636766 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
23:54:26.638574 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
23:54:26.640222 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
23:54:26.642902 [debug] [MainThread]: Parsing macros/adapters/columns.sql
23:54:26.648848 [debug] [MainThread]: Parsing macros/adapters/schema.sql
23:54:26.650318 [debug] [MainThread]: Parsing macros/adapters/relation.sql
23:54:26.656261 [debug] [MainThread]: Parsing tests/generic/builtin.sql
23:54:26.768671 [debug] [MainThread]: 1699: static parser successfully parsed advert/merger_model.sql
23:54:26.796107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ad.example

23:54:26.800501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2329e807-39b6-4dfc-84d0-d59f2c03facc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716813d160>]}
23:54:26.806297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2329e807-39b6-4dfc-84d0-d59f2c03facc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716811f100>]}
23:54:26.806908 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
23:54:26.807505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2329e807-39b6-4dfc-84d0-d59f2c03facc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7169021fa0>]}
23:54:26.808456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7169045370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7168189f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71681897f0>]}


============================== 2022-08-09 23:54:45.075287 | af40efc1-516b-43db-8040-2cd33682b08f ==============================
23:54:45.075303 [info ] [MainThread]: Running with dbt=1.1.1
23:54:45.075766 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
23:54:45.075916 [debug] [MainThread]: Tracking: tracking
23:54:45.093424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0fff4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0fff4df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0fff4fd0>]}
23:54:45.118332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:54:45.118541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:54:45.118860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ad.example

23:54:45.123455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af40efc1-516b-43db-8040-2cd33682b08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0ff97550>]}
23:54:45.127447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af40efc1-516b-43db-8040-2cd33682b08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a10037070>]}
23:54:45.127796 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
23:54:45.128105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af40efc1-516b-43db-8040-2cd33682b08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a10037190>]}
23:54:45.129299 [info ] [MainThread]: 
23:54:45.129586 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
23:54:45.132938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a10037100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a10010970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0fff4f40>]}


============================== 2022-08-09 23:55:48.136516 | a92ea432-e3b8-4685-97a8-72368c62fc4c ==============================
23:55:48.136535 [info ] [MainThread]: Running with dbt=1.1.1
23:55:48.137094 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
23:55:48.137339 [debug] [MainThread]: Tracking: tracking
23:55:48.157693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81edea4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81edea4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81edea4f40>]}
23:55:48.173480 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
23:55:48.173851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a92ea432-e3b8-4685-97a8-72368c62fc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81edec04f0>]}
23:55:48.181343 [debug] [MainThread]: Parsing macros/relations.sql
23:55:48.182916 [debug] [MainThread]: Parsing macros/adapters.sql
23:55:48.201332 [debug] [MainThread]: Parsing macros/catalog.sql
23:55:48.203346 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
23:55:48.204685 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
23:55:48.206740 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
23:55:48.208601 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
23:55:48.210511 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
23:55:48.211295 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
23:55:48.212008 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
23:55:48.213061 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
23:55:48.213710 [debug] [MainThread]: Parsing macros/materializations/configs.sql
23:55:48.215333 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
23:55:48.218149 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
23:55:48.230030 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
23:55:48.235165 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
23:55:48.236267 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
23:55:48.247436 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
23:55:48.253480 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
23:55:48.263936 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
23:55:48.266697 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
23:55:48.268660 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
23:55:48.273471 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
23:55:48.277993 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
23:55:48.279905 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
23:55:48.280711 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
23:55:48.282584 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
23:55:48.289248 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
23:55:48.299603 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
23:55:48.300702 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
23:55:48.308433 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
23:55:48.309707 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
23:55:48.310963 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
23:55:48.313880 [debug] [MainThread]: Parsing macros/etc/datetime.sql
23:55:48.318955 [debug] [MainThread]: Parsing macros/etc/statement.sql
23:55:48.321690 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
23:55:48.326222 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
23:55:48.328609 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
23:55:48.330481 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
23:55:48.333259 [debug] [MainThread]: Parsing macros/adapters/columns.sql
23:55:48.339886 [debug] [MainThread]: Parsing macros/adapters/schema.sql
23:55:48.341230 [debug] [MainThread]: Parsing macros/adapters/relation.sql
23:55:48.347014 [debug] [MainThread]: Parsing tests/generic/builtin.sql
23:55:48.460507 [debug] [MainThread]: 1699: static parser successfully parsed advert/merger_model.sql
23:55:48.491683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a92ea432-e3b8-4685-97a8-72368c62fc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ecda3370>]}
23:55:48.494435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a92ea432-e3b8-4685-97a8-72368c62fc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81eded8fd0>]}
23:55:48.494735 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
23:55:48.495011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a92ea432-e3b8-4685-97a8-72368c62fc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ecdcdf70>]}
23:55:48.495952 [info ] [MainThread]: 
23:55:48.496246 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
23:55:48.499194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ecdcdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ecda3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ecda3700>]}


============================== 2022-08-09 23:59:51.533510 | 3c31a287-f097-485a-8c5c-26f4d21765ff ==============================
23:59:51.533527 [info ] [MainThread]: Running with dbt=1.1.1
23:59:51.533981 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:59:51.534133 [debug] [MainThread]: Tracking: tracking
23:59:51.554037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae8afbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae8afbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae8afbf40>]}
23:59:51.570989 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
23:59:51.571363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c31a287-f097-485a-8c5c-26f4d21765ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae8b114f0>]}
23:59:51.578535 [debug] [MainThread]: Parsing macros/relations.sql
23:59:51.580046 [debug] [MainThread]: Parsing macros/adapters.sql
23:59:51.603020 [debug] [MainThread]: Parsing macros/catalog.sql
23:59:51.605483 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
23:59:51.606945 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
23:59:51.608701 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
23:59:51.609880 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
23:59:51.610911 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
23:59:51.611461 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
23:59:51.611932 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
23:59:51.612894 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
23:59:51.613933 [debug] [MainThread]: Parsing macros/materializations/configs.sql
23:59:51.615930 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
23:59:51.620372 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
23:59:51.631794 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
23:59:51.637137 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
23:59:51.638241 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
23:59:51.647915 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
23:59:51.655652 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
23:59:51.665509 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
23:59:51.668426 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
23:59:51.670316 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
23:59:51.675106 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
23:59:51.680285 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
23:59:51.682484 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
23:59:51.683410 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
23:59:51.685182 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
23:59:51.691619 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
23:59:51.701767 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
23:59:51.702871 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
23:59:51.710528 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
23:59:51.711686 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
23:59:51.712792 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
23:59:51.715655 [debug] [MainThread]: Parsing macros/etc/datetime.sql
23:59:51.720829 [debug] [MainThread]: Parsing macros/etc/statement.sql
23:59:51.723605 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
23:59:51.728049 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
23:59:51.730063 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
23:59:51.731776 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
23:59:51.734507 [debug] [MainThread]: Parsing macros/adapters/columns.sql
23:59:51.741088 [debug] [MainThread]: Parsing macros/adapters/schema.sql
23:59:51.742650 [debug] [MainThread]: Parsing macros/adapters/relation.sql
23:59:51.748998 [debug] [MainThread]: Parsing tests/generic/builtin.sql
23:59:51.864531 [debug] [MainThread]: 1699: static parser successfully parsed advert/merger_model.sql
23:59:51.905547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c31a287-f097-485a-8c5c-26f4d21765ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead7989370>]}
23:59:51.908611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c31a287-f097-485a-8c5c-26f4d21765ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae8b29fd0>]}
23:59:51.908866 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
23:59:51.909130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c31a287-f097-485a-8c5c-26f4d21765ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead79b2f70>]}
23:59:51.910202 [info ] [MainThread]: 
23:59:51.910708 [debug] [MainThread]: Acquiring new postgres connection "master"
23:59:51.911463 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
23:59:51.919941 [debug] [ThreadPool]: Using postgres connection "list_trial"
23:59:51.920397 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
23:59:51.920697 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:59:51.931497 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
23:59:51.933122 [debug] [ThreadPool]: On list_trial: Close
23:59:51.934621 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
23:59:51.941620 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
23:59:51.941847 [debug] [ThreadPool]: On list_trial_trial: BEGIN
23:59:51.942011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:59:51.949229 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:59:51.949838 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
23:59:51.950111 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
23:59:51.957636 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
23:59:51.958722 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
23:59:51.959003 [debug] [ThreadPool]: On list_trial_trial: Close
23:59:51.962690 [debug] [MainThread]: Using postgres connection "master"
23:59:51.962840 [debug] [MainThread]: On master: BEGIN
23:59:51.962948 [debug] [MainThread]: Opening a new connection, currently in state init
23:59:51.971067 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:59:51.971323 [debug] [MainThread]: Using postgres connection "master"
23:59:51.971492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:59:51.993217 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
23:59:51.994453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c31a287-f097-485a-8c5c-26f4d21765ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead7989430>]}
23:59:51.994722 [debug] [MainThread]: On master: ROLLBACK
23:59:51.995078 [debug] [MainThread]: Using postgres connection "master"
23:59:51.995218 [debug] [MainThread]: On master: BEGIN
23:59:51.995641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:59:51.995791 [debug] [MainThread]: On master: COMMIT
23:59:51.995906 [debug] [MainThread]: Using postgres connection "master"
23:59:51.996010 [debug] [MainThread]: On master: COMMIT
23:59:51.996275 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:59:51.996452 [debug] [MainThread]: On master: Close
23:59:51.996879 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
23:59:51.997187 [info ] [MainThread]: 
23:59:52.000197 [debug] [Thread-1  ]: Began running node model.ad.merger_model
23:59:52.000518 [info ] [Thread-1  ]: 1 of 1 START table model trial.merger_model .................................... [RUN]
23:59:52.001132 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
23:59:52.001320 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
23:59:52.001530 [debug] [Thread-1  ]: Compiling model.ad.merger_model
23:59:52.004467 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
23:59:52.005469 [debug] [Thread-1  ]: finished collecting timing info
23:59:52.005689 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
23:59:52.030355 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
23:59:52.031508 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
23:59:52.031947 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
23:59:52.032100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:59:52.039558 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:59:52.039983 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
23:59:52.040146 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."trial"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."trial"."briefing";
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."trial"."campaigns_inventory" left join "trial"."trial"."design" using ("game_key") left join tempbriefing using ("campaign_id");
  );
23:59:52.041174 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18:         "trial"."trial"."briefing";
                                           ^

23:59:52.041367 [debug] [Thread-1  ]: On model.ad.merger_model: ROLLBACK
23:59:52.041769 [debug] [Thread-1  ]: finished collecting timing info
23:59:52.041962 [debug] [Thread-1  ]: On model.ad.merger_model: Close
23:59:52.042473 [debug] [Thread-1  ]: Database Error in model merger_model (models/advert/merger_model.sql)
  syntax error at or near ";"
  LINE 18:         "trial"."trial"."briefing";
                                             ^
  compiled SQL at target/run/ad/models/advert/merger_model.sql
23:59:52.042802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c31a287-f097-485a-8c5c-26f4d21765ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead79dc970>]}
23:59:52.043170 [error] [Thread-1  ]: 1 of 1 ERROR creating table model trial.merger_model ........................... [[31mERROR[0m in 0.04s]
23:59:52.043712 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
23:59:52.045048 [debug] [MainThread]: Acquiring new postgres connection "master"
23:59:52.045312 [debug] [MainThread]: Using postgres connection "master"
23:59:52.045519 [debug] [MainThread]: On master: BEGIN
23:59:52.045667 [debug] [MainThread]: Opening a new connection, currently in state closed
23:59:52.052888 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:59:52.053708 [debug] [MainThread]: On master: COMMIT
23:59:52.053891 [debug] [MainThread]: Using postgres connection "master"
23:59:52.054037 [debug] [MainThread]: On master: COMMIT
23:59:52.054297 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:59:52.054467 [debug] [MainThread]: On master: Close
23:59:52.054867 [info ] [MainThread]: 
23:59:52.055135 [info ] [MainThread]: Finished running 1 table model in 0.14s.
23:59:52.055383 [debug] [MainThread]: Connection 'master' was properly closed.
23:59:52.055515 [debug] [MainThread]: Connection 'model.ad.merger_model' was properly closed.
23:59:52.058722 [info ] [MainThread]: 
23:59:52.059001 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:59:52.059295 [info ] [MainThread]: 
23:59:52.059616 [error] [MainThread]: [33mDatabase Error in model merger_model (models/advert/merger_model.sql)[0m
23:59:52.059908 [error] [MainThread]:   syntax error at or near ";"
23:59:52.060273 [error] [MainThread]:   LINE 18:         "trial"."trial"."briefing";
23:59:52.060833 [error] [MainThread]:                                              ^
23:59:52.061540 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/merger_model.sql
23:59:52.062047 [info ] [MainThread]: 
23:59:52.062560 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
23:59:52.063198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead79e6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead79d1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead79d14f0>]}


============================== 2022-08-10 00:01:09.272300 | 06b5fb37-06c3-4595-ac2a-ca1b011dc19d ==============================
00:01:09.272316 [info ] [MainThread]: Running with dbt=1.1.1
00:01:09.272812 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:01:09.272943 [debug] [MainThread]: Tracking: tracking
00:01:09.293437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff828fc9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff828fc9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff828fc9fd0>]}
00:01:09.314449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:01:09.314772 [debug] [MainThread]: Partial parsing: updated file: ad://models/advert/merger_model.sql
00:01:09.326814 [debug] [MainThread]: 1699: static parser successfully parsed advert/merger_model.sql
00:01:09.341282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06b5fb37-06c3-4595-ac2a-ca1b011dc19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff828f32fa0>]}
00:01:09.344173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06b5fb37-06c3-4595-ac2a-ca1b011dc19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82902bd00>]}
00:01:09.344424 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:01:09.344676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06b5fb37-06c3-4595-ac2a-ca1b011dc19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff828f46580>]}
00:01:09.345752 [info ] [MainThread]: 
00:01:09.346287 [debug] [MainThread]: Acquiring new postgres connection "master"
00:01:09.347166 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:01:09.355850 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:01:09.356132 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:01:09.356305 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:01:09.364948 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:01:09.366225 [debug] [ThreadPool]: On list_trial: Close
00:01:09.367431 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
00:01:09.371663 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
00:01:09.371796 [debug] [ThreadPool]: On list_trial_trial: BEGIN
00:01:09.371892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:01:09.381023 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:01:09.381332 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
00:01:09.381516 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
00:01:09.383567 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
00:01:09.384657 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
00:01:09.384939 [debug] [ThreadPool]: On list_trial_trial: Close
00:01:09.388387 [debug] [MainThread]: Using postgres connection "master"
00:01:09.388546 [debug] [MainThread]: On master: BEGIN
00:01:09.388652 [debug] [MainThread]: Opening a new connection, currently in state init
00:01:09.396224 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:01:09.396549 [debug] [MainThread]: Using postgres connection "master"
00:01:09.396704 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:01:09.413250 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:01:09.414605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06b5fb37-06c3-4595-ac2a-ca1b011dc19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff828fc9fa0>]}
00:01:09.414896 [debug] [MainThread]: On master: ROLLBACK
00:01:09.415249 [debug] [MainThread]: Using postgres connection "master"
00:01:09.415366 [debug] [MainThread]: On master: BEGIN
00:01:09.415586 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:01:09.415711 [debug] [MainThread]: On master: COMMIT
00:01:09.415836 [debug] [MainThread]: Using postgres connection "master"
00:01:09.415950 [debug] [MainThread]: On master: COMMIT
00:01:09.416144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:01:09.416271 [debug] [MainThread]: On master: Close
00:01:09.416716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:01:09.417022 [info ] [MainThread]: 
00:01:09.419415 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:01:09.419714 [info ] [Thread-1  ]: 1 of 1 START table model trial.merger_model .................................... [RUN]
00:01:09.420192 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:01:09.420354 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:01:09.420503 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:01:09.423776 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:01:09.424109 [debug] [Thread-1  ]: finished collecting timing info
00:01:09.424278 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:01:09.446087 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:01:09.446509 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:01:09.446689 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:01:09.446868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:01:09.454313 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:01:09.454622 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:01:09.454751 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."trial"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."trial"."briefing";
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."trial"."campaigns_inventory" left join "trial"."trial"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:01:09.455086 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18:         "trial"."trial"."briefing";
                                           ^

00:01:09.455223 [debug] [Thread-1  ]: On model.ad.merger_model: ROLLBACK
00:01:09.455543 [debug] [Thread-1  ]: finished collecting timing info
00:01:09.455704 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:01:09.456150 [debug] [Thread-1  ]: Database Error in model merger_model (models/advert/merger_model.sql)
  syntax error at or near ";"
  LINE 18:         "trial"."trial"."briefing";
                                             ^
  compiled SQL at target/run/ad/models/advert/merger_model.sql
00:01:09.456443 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b5fb37-06c3-4595-ac2a-ca1b011dc19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff828f54c10>]}
00:01:09.456779 [error] [Thread-1  ]: 1 of 1 ERROR creating table model trial.merger_model ........................... [[31mERROR[0m in 0.04s]
00:01:09.457195 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:01:09.458176 [debug] [MainThread]: Acquiring new postgres connection "master"
00:01:09.458382 [debug] [MainThread]: Using postgres connection "master"
00:01:09.458496 [debug] [MainThread]: On master: BEGIN
00:01:09.458608 [debug] [MainThread]: Opening a new connection, currently in state closed
00:01:09.466248 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:01:09.466507 [debug] [MainThread]: On master: COMMIT
00:01:09.466655 [debug] [MainThread]: Using postgres connection "master"
00:01:09.466786 [debug] [MainThread]: On master: COMMIT
00:01:09.466971 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:01:09.467127 [debug] [MainThread]: On master: Close
00:01:09.467629 [info ] [MainThread]: 
00:01:09.467960 [info ] [MainThread]: Finished running 1 table model in 0.12s.
00:01:09.468219 [debug] [MainThread]: Connection 'master' was properly closed.
00:01:09.468356 [debug] [MainThread]: Connection 'model.ad.merger_model' was properly closed.
00:01:09.471931 [info ] [MainThread]: 
00:01:09.472270 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:01:09.472545 [info ] [MainThread]: 
00:01:09.472931 [error] [MainThread]: [33mDatabase Error in model merger_model (models/advert/merger_model.sql)[0m
00:01:09.473245 [error] [MainThread]:   syntax error at or near ";"
00:01:09.473527 [error] [MainThread]:   LINE 18:         "trial"."trial"."briefing";
00:01:09.473811 [error] [MainThread]:                                              ^
00:01:09.474192 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/merger_model.sql
00:01:09.474446 [info ] [MainThread]: 
00:01:09.474714 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:01:09.475227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8280aa2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff828f46520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8280ba940>]}


============================== 2022-08-10 00:01:22.297834 | 81164d03-2c18-4fef-91da-bc1ff77fd7e0 ==============================
00:01:22.297851 [info ] [MainThread]: Running with dbt=1.1.1
00:01:22.298393 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:01:22.298531 [debug] [MainThread]: Tracking: tracking
00:01:22.319184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2c2ba040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2c2ba130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2c2ba100>]}
00:01:22.342143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:01:22.342541 [debug] [MainThread]: Partial parsing: updated file: ad://models/advert/merger_model.sql
00:01:22.355341 [debug] [MainThread]: 1699: static parser successfully parsed advert/merger_model.sql
00:01:22.368539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81164d03-2c18-4fef-91da-bc1ff77fd7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2c2071c0>]}
00:01:22.373387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81164d03-2c18-4fef-91da-bc1ff77fd7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2c2f6e80>]}
00:01:22.373660 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:01:22.373929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81164d03-2c18-4fef-91da-bc1ff77fd7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2c21c6a0>]}
00:01:22.374946 [info ] [MainThread]: 
00:01:22.375423 [debug] [MainThread]: Acquiring new postgres connection "master"
00:01:22.376220 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:01:22.384948 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:01:22.385273 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:01:22.385554 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:01:22.395095 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:01:22.396328 [debug] [ThreadPool]: On list_trial: Close
00:01:22.397819 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
00:01:22.403892 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
00:01:22.404280 [debug] [ThreadPool]: On list_trial_trial: BEGIN
00:01:22.404521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:01:22.412173 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:01:22.412470 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
00:01:22.412603 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
00:01:22.414399 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
00:01:22.415991 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
00:01:22.416484 [debug] [ThreadPool]: On list_trial_trial: Close
00:01:22.420422 [debug] [MainThread]: Using postgres connection "master"
00:01:22.420604 [debug] [MainThread]: On master: BEGIN
00:01:22.420722 [debug] [MainThread]: Opening a new connection, currently in state init
00:01:22.428123 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:01:22.428288 [debug] [MainThread]: Using postgres connection "master"
00:01:22.428392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:01:22.444043 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:01:22.445482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81164d03-2c18-4fef-91da-bc1ff77fd7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2b1c6cd0>]}
00:01:22.445785 [debug] [MainThread]: On master: ROLLBACK
00:01:22.446164 [debug] [MainThread]: Using postgres connection "master"
00:01:22.446330 [debug] [MainThread]: On master: BEGIN
00:01:22.446739 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:01:22.446907 [debug] [MainThread]: On master: COMMIT
00:01:22.447039 [debug] [MainThread]: Using postgres connection "master"
00:01:22.447156 [debug] [MainThread]: On master: COMMIT
00:01:22.447370 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:01:22.447526 [debug] [MainThread]: On master: Close
00:01:22.447982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:01:22.448255 [info ] [MainThread]: 
00:01:22.451027 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:01:22.451409 [info ] [Thread-1  ]: 1 of 1 START table model trial.merger_model .................................... [RUN]
00:01:22.451912 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:01:22.452110 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:01:22.452267 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:01:22.455489 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:01:22.455810 [debug] [Thread-1  ]: finished collecting timing info
00:01:22.455961 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:01:22.479545 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:01:22.480012 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:01:22.480170 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:01:22.480295 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:01:22.488111 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:01:22.488352 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:01:22.488485 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."trial"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."trial"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."trial"."campaigns_inventory" left join "trial"."trial"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:01:22.489621 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "trial.briefing" does not exist
LINE 18:         "trial"."trial"."briefing"
                 ^

00:01:22.489818 [debug] [Thread-1  ]: On model.ad.merger_model: ROLLBACK
00:01:22.490279 [debug] [Thread-1  ]: finished collecting timing info
00:01:22.490438 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:01:22.490880 [debug] [Thread-1  ]: Database Error in model merger_model (models/advert/merger_model.sql)
  relation "trial.briefing" does not exist
  LINE 18:         "trial"."trial"."briefing"
                   ^
  compiled SQL at target/run/ad/models/advert/merger_model.sql
00:01:22.491156 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81164d03-2c18-4fef-91da-bc1ff77fd7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2c247f10>]}
00:01:22.491487 [error] [Thread-1  ]: 1 of 1 ERROR creating table model trial.merger_model ........................... [[31mERROR[0m in 0.04s]
00:01:22.491936 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:01:22.493366 [debug] [MainThread]: Acquiring new postgres connection "master"
00:01:22.493605 [debug] [MainThread]: Using postgres connection "master"
00:01:22.493772 [debug] [MainThread]: On master: BEGIN
00:01:22.493916 [debug] [MainThread]: Opening a new connection, currently in state closed
00:01:22.501988 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:01:22.502226 [debug] [MainThread]: On master: COMMIT
00:01:22.502361 [debug] [MainThread]: Using postgres connection "master"
00:01:22.502485 [debug] [MainThread]: On master: COMMIT
00:01:22.502659 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:01:22.502807 [debug] [MainThread]: On master: Close
00:01:22.503235 [info ] [MainThread]: 
00:01:22.503528 [info ] [MainThread]: Finished running 1 table model in 0.13s.
00:01:22.503823 [debug] [MainThread]: Connection 'master' was properly closed.
00:01:22.503981 [debug] [MainThread]: Connection 'model.ad.merger_model' was properly closed.
00:01:22.507080 [info ] [MainThread]: 
00:01:22.507366 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:01:22.507688 [info ] [MainThread]: 
00:01:22.507969 [error] [MainThread]: [33mDatabase Error in model merger_model (models/advert/merger_model.sql)[0m
00:01:22.508242 [error] [MainThread]:   relation "trial.briefing" does not exist
00:01:22.508511 [error] [MainThread]:   LINE 18:         "trial"."trial"."briefing"
00:01:22.508797 [error] [MainThread]:                    ^
00:01:22.509065 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/merger_model.sql
00:01:22.509358 [info ] [MainThread]: 
00:01:22.509642 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:01:22.510051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2c2302e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2c21c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2a9876d0>]}


============================== 2022-08-10 00:01:56.722115 | fbd3b2a9-af21-48d3-a4e6-1db08425f86c ==============================
00:01:56.722131 [info ] [MainThread]: Running with dbt=1.1.1
00:01:56.722624 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:01:56.722771 [debug] [MainThread]: Tracking: tracking
00:01:56.742787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884d5cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884d5cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884d5cfa0>]}
00:01:56.759366 [info ] [MainThread]: Unable to do partial parsing because profile has changed
00:01:56.760007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fbd3b2a9-af21-48d3-a4e6-1db08425f86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884d76550>]}
00:01:56.766838 [debug] [MainThread]: Parsing macros/relations.sql
00:01:56.768313 [debug] [MainThread]: Parsing macros/adapters.sql
00:01:56.788319 [debug] [MainThread]: Parsing macros/catalog.sql
00:01:56.790649 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:01:56.792452 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:01:56.794816 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:01:56.795899 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:01:56.796964 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:01:56.797887 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:01:56.798359 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:01:56.799292 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:01:56.799939 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:01:56.801561 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:01:56.804885 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:01:56.818691 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:01:56.823971 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:01:56.825186 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:01:56.834936 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:01:56.841204 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:01:56.851007 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:01:56.853897 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:01:56.855849 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:01:56.860489 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:01:56.864708 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:01:56.866174 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:01:56.867029 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:01:56.868753 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:01:56.875465 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:01:56.885482 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:01:56.886534 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:01:56.894401 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:01:56.895599 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:01:56.896777 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:01:56.899645 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:01:56.904867 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:01:56.907693 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:01:56.912069 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:01:56.914215 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:01:56.915883 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:01:56.918673 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:01:56.924592 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:01:56.926039 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:01:56.931912 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:01:57.046092 [debug] [MainThread]: 1699: static parser successfully parsed advert/merger_model.sql
00:01:57.076760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbd3b2a9-af21-48d3-a4e6-1db08425f86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8840201c0>]}
00:01:57.079500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbd3b2a9-af21-48d3-a4e6-1db08425f86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884d5cf10>]}
00:01:57.079809 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:01:57.080067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbd3b2a9-af21-48d3-a4e6-1db08425f86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884d76a90>]}
00:01:57.081222 [info ] [MainThread]: 
00:01:57.081894 [debug] [MainThread]: Acquiring new postgres connection "master"
00:01:57.082857 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:01:57.091625 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:01:57.092083 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:01:57.092260 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:01:57.103662 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:01:57.105656 [debug] [ThreadPool]: On list_trial: Close
00:01:57.107210 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:01:57.113065 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:01:57.113315 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:01:57.113481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:01:57.120486 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:01:57.120729 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:01:57.120897 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:01:57.123143 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
00:01:57.124741 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:01:57.125112 [debug] [ThreadPool]: On list_trial_public: Close
00:01:57.130092 [debug] [MainThread]: Using postgres connection "master"
00:01:57.130284 [debug] [MainThread]: On master: BEGIN
00:01:57.130409 [debug] [MainThread]: Opening a new connection, currently in state init
00:01:57.137999 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:01:57.138220 [debug] [MainThread]: Using postgres connection "master"
00:01:57.138357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:01:57.155779 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:01:57.157035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbd3b2a9-af21-48d3-a4e6-1db08425f86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8840208b0>]}
00:01:57.157579 [debug] [MainThread]: On master: ROLLBACK
00:01:57.157977 [debug] [MainThread]: Using postgres connection "master"
00:01:57.158133 [debug] [MainThread]: On master: BEGIN
00:01:57.158656 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:01:57.158815 [debug] [MainThread]: On master: COMMIT
00:01:57.158938 [debug] [MainThread]: Using postgres connection "master"
00:01:57.159050 [debug] [MainThread]: On master: COMMIT
00:01:57.159323 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:01:57.159448 [debug] [MainThread]: On master: Close
00:01:57.159853 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:01:57.160080 [info ] [MainThread]: 
00:01:57.163198 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:01:57.163508 [info ] [Thread-1  ]: 1 of 1 START table model public.merger_model ................................... [RUN]
00:01:57.164105 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:01:57.164294 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:01:57.164457 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:01:57.167753 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:01:57.168132 [debug] [Thread-1  ]: finished collecting timing info
00:01:57.168325 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:01:57.192631 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:01:57.193040 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:01:57.193197 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:01:57.193316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:01:57.200905 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:01:57.201239 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:01:57.201390 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."public"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."trial"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."trial"."campaigns_inventory" left join "trial"."trial"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:01:57.201745 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "trial.briefing" does not exist
LINE 18:         "trial"."trial"."briefing"
                 ^

00:01:57.201923 [debug] [Thread-1  ]: On model.ad.merger_model: ROLLBACK
00:01:57.202241 [debug] [Thread-1  ]: finished collecting timing info
00:01:57.202403 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:01:57.202835 [debug] [Thread-1  ]: Database Error in model merger_model (models/advert/merger_model.sql)
  relation "trial.briefing" does not exist
  LINE 18:         "trial"."trial"."briefing"
                   ^
  compiled SQL at target/run/ad/models/advert/merger_model.sql
00:01:57.203114 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd3b2a9-af21-48d3-a4e6-1db08425f86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884020820>]}
00:01:57.203471 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.merger_model .......................... [[31mERROR[0m in 0.04s]
00:01:57.203953 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:01:57.205002 [debug] [MainThread]: Acquiring new postgres connection "master"
00:01:57.205284 [debug] [MainThread]: Using postgres connection "master"
00:01:57.205446 [debug] [MainThread]: On master: BEGIN
00:01:57.205599 [debug] [MainThread]: Opening a new connection, currently in state closed
00:01:57.213041 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:01:57.213325 [debug] [MainThread]: On master: COMMIT
00:01:57.213469 [debug] [MainThread]: Using postgres connection "master"
00:01:57.213603 [debug] [MainThread]: On master: COMMIT
00:01:57.213793 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:01:57.213975 [debug] [MainThread]: On master: Close
00:01:57.214508 [info ] [MainThread]: 
00:01:57.214823 [info ] [MainThread]: Finished running 1 table model in 0.13s.
00:01:57.215095 [debug] [MainThread]: Connection 'master' was properly closed.
00:01:57.215232 [debug] [MainThread]: Connection 'model.ad.merger_model' was properly closed.
00:01:57.218494 [info ] [MainThread]: 
00:01:57.218771 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:01:57.219089 [info ] [MainThread]: 
00:01:57.219336 [error] [MainThread]: [33mDatabase Error in model merger_model (models/advert/merger_model.sql)[0m
00:01:57.219583 [error] [MainThread]:   relation "trial.briefing" does not exist
00:01:57.219829 [error] [MainThread]:   LINE 18:         "trial"."trial"."briefing"
00:01:57.220092 [error] [MainThread]:                    ^
00:01:57.220357 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/merger_model.sql
00:01:57.220636 [info ] [MainThread]: 
00:01:57.220917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:01:57.221306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884d76460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884c9ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa884090130>]}


============================== 2022-08-10 00:02:10.803929 | 2a1c517e-6841-4d86-af68-81d0fc039c2c ==============================
00:02:10.803935 [info ] [MainThread]: Running with dbt=1.1.1
00:02:10.804232 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
00:02:10.804353 [debug] [MainThread]: Tracking: tracking
00:02:10.821509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107b0fc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107b0fc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107b0fc310>]}
00:02:10.871827 [debug] [MainThread]: Executing "git --help"
00:02:10.877009 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
00:02:10.877411 [debug] [MainThread]: STDERR: "b''"
00:02:10.880206 [debug] [MainThread]: Acquiring new postgres connection "debug"
00:02:10.880731 [debug] [MainThread]: Using postgres connection "debug"
00:02:10.880895 [debug] [MainThread]: On debug: select 1 as id
00:02:10.881037 [debug] [MainThread]: Opening a new connection, currently in state init
00:02:10.892705 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
00:02:10.894603 [debug] [MainThread]: On debug: Close
00:02:10.895202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107a7f5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107a7f5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107a7f55e0>]}
00:02:12.240412 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-10 00:02:17.213603 | 938c7eb1-f223-43dd-98b4-5d1b8ec88326 ==============================
00:02:17.213621 [info ] [MainThread]: Running with dbt=1.1.1
00:02:17.214268 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:02:17.214426 [debug] [MainThread]: Tracking: tracking
00:02:17.234433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9474b1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9474cc0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9474cc0d0>]}
00:02:17.255706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:02:17.255874 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:02:17.260570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '938c7eb1-f223-43dd-98b4-5d1b8ec88326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9474515b0>]}
00:02:17.263382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '938c7eb1-f223-43dd-98b4-5d1b8ec88326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc947441190>]}
00:02:17.263590 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:02:17.263835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '938c7eb1-f223-43dd-98b4-5d1b8ec88326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc947441250>]}
00:02:17.264823 [info ] [MainThread]: 
00:02:17.265379 [debug] [MainThread]: Acquiring new postgres connection "master"
00:02:17.266394 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:02:17.274350 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:02:17.274505 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:02:17.274610 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:17.283647 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:02:17.285526 [debug] [ThreadPool]: On list_trial: Close
00:02:17.286845 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:02:17.291368 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:02:17.291719 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:02:17.291864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:02:17.300418 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:02:17.300720 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:02:17.300905 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:02:17.302890 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
00:02:17.304576 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:02:17.304890 [debug] [ThreadPool]: On list_trial_public: Close
00:02:17.308666 [debug] [MainThread]: Using postgres connection "master"
00:02:17.308851 [debug] [MainThread]: On master: BEGIN
00:02:17.308985 [debug] [MainThread]: Opening a new connection, currently in state init
00:02:17.317577 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:02:17.317850 [debug] [MainThread]: Using postgres connection "master"
00:02:17.317987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:02:17.335273 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:02:17.336891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '938c7eb1-f223-43dd-98b4-5d1b8ec88326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc947418490>]}
00:02:17.337195 [debug] [MainThread]: On master: ROLLBACK
00:02:17.337543 [debug] [MainThread]: Using postgres connection "master"
00:02:17.337706 [debug] [MainThread]: On master: BEGIN
00:02:17.338223 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:02:17.338392 [debug] [MainThread]: On master: COMMIT
00:02:17.338522 [debug] [MainThread]: Using postgres connection "master"
00:02:17.338652 [debug] [MainThread]: On master: COMMIT
00:02:17.338849 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:02:17.338999 [debug] [MainThread]: On master: Close
00:02:17.339596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:02:17.340051 [info ] [MainThread]: 
00:02:17.342813 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:02:17.343142 [info ] [Thread-1  ]: 1 of 1 START table model public.merger_model ................................... [RUN]
00:02:17.344169 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:02:17.344431 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:02:17.344622 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:02:17.347354 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:02:17.347656 [debug] [Thread-1  ]: finished collecting timing info
00:02:17.347799 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:02:17.369855 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:02:17.370290 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:02:17.370459 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:02:17.370593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:02:17.378755 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:02:17.379013 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:02:17.379135 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."public"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."trial"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."trial"."campaigns_inventory" left join "trial"."trial"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:02:17.379492 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "trial.briefing" does not exist
LINE 18:         "trial"."trial"."briefing"
                 ^

00:02:17.379666 [debug] [Thread-1  ]: On model.ad.merger_model: ROLLBACK
00:02:17.380017 [debug] [Thread-1  ]: finished collecting timing info
00:02:17.380178 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:02:17.380611 [debug] [Thread-1  ]: Database Error in model merger_model (models/advert/merger_model.sql)
  relation "trial.briefing" does not exist
  LINE 18:         "trial"."trial"."briefing"
                   ^
  compiled SQL at target/run/ad/models/advert/merger_model.sql
00:02:17.380895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '938c7eb1-f223-43dd-98b4-5d1b8ec88326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc94538da60>]}
00:02:17.381623 [error] [Thread-1  ]: 1 of 1 ERROR creating table model public.merger_model .......................... [[31mERROR[0m in 0.04s]
00:02:17.382142 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:02:17.383335 [debug] [MainThread]: Acquiring new postgres connection "master"
00:02:17.383590 [debug] [MainThread]: Using postgres connection "master"
00:02:17.383865 [debug] [MainThread]: On master: BEGIN
00:02:17.384122 [debug] [MainThread]: Opening a new connection, currently in state closed
00:02:17.391501 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:02:17.391838 [debug] [MainThread]: On master: COMMIT
00:02:17.392094 [debug] [MainThread]: Using postgres connection "master"
00:02:17.392322 [debug] [MainThread]: On master: COMMIT
00:02:17.392622 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:02:17.392890 [debug] [MainThread]: On master: Close
00:02:17.393884 [info ] [MainThread]: 
00:02:17.394346 [info ] [MainThread]: Finished running 1 table model in 0.13s.
00:02:17.394829 [debug] [MainThread]: Connection 'master' was properly closed.
00:02:17.395085 [debug] [MainThread]: Connection 'model.ad.merger_model' was properly closed.
00:02:17.399866 [info ] [MainThread]: 
00:02:17.400251 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:02:17.400573 [info ] [MainThread]: 
00:02:17.400924 [error] [MainThread]: [33mDatabase Error in model merger_model (models/advert/merger_model.sql)[0m
00:02:17.401206 [error] [MainThread]:   relation "trial.briefing" does not exist
00:02:17.401458 [error] [MainThread]:   LINE 18:         "trial"."trial"."briefing"
00:02:17.401813 [error] [MainThread]:                    ^
00:02:17.402101 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/merger_model.sql
00:02:17.402408 [info ] [MainThread]: 
00:02:17.402711 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
00:02:17.403099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc946be4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc946be4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc946be4370>]}


============================== 2022-08-10 00:02:28.837164 | 0db10287-6867-45f1-8479-f5ea070a9d96 ==============================
00:02:28.837184 [info ] [MainThread]: Running with dbt=1.1.1
00:02:28.837767 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:02:28.837917 [debug] [MainThread]: Tracking: tracking
00:02:28.859304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e02c89040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e02c89130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e02c89100>]}
00:02:28.882366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:02:28.882751 [debug] [MainThread]: Partial parsing: deleted source source.ad.public.warehouse
00:02:28.883147 [debug] [MainThread]: Partial parsing: deleted source source.ad.public.design
00:02:28.883268 [debug] [MainThread]: Partial parsing: deleted source source.ad.public.campaigns_inventory
00:02:28.883377 [debug] [MainThread]: Partial parsing: deleted source source.ad.public.briefing
00:02:28.883502 [debug] [MainThread]: Partial parsing: update schema file: ad://models/advert/schema.yml
00:02:28.896683 [debug] [MainThread]: 1699: static parser successfully parsed advert/merger_model.sql
00:02:28.921037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0db10287-6867-45f1-8479-f5ea070a9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e01b61c10>]}
00:02:28.923857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0db10287-6867-45f1-8479-f5ea070a9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e02c62d60>]}
00:02:28.924112 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:02:28.924385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0db10287-6867-45f1-8479-f5ea070a9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e02c62f40>]}
00:02:28.925393 [info ] [MainThread]: 
00:02:28.925906 [debug] [MainThread]: Acquiring new postgres connection "master"
00:02:28.926591 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:02:28.934673 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:02:28.934969 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:02:28.935161 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:02:28.946527 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:02:28.948702 [debug] [ThreadPool]: On list_trial: Close
00:02:28.949831 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:02:28.955172 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:02:28.955436 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:02:28.955593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:02:28.963728 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:02:28.963968 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:02:28.964099 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:02:28.965940 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
00:02:28.967034 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:02:28.967325 [debug] [ThreadPool]: On list_trial_public: Close
00:02:28.971906 [debug] [MainThread]: Using postgres connection "master"
00:02:28.972393 [debug] [MainThread]: On master: BEGIN
00:02:28.972551 [debug] [MainThread]: Opening a new connection, currently in state init
00:02:28.980393 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:02:28.980629 [debug] [MainThread]: Using postgres connection "master"
00:02:28.980764 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:02:28.997043 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:02:28.998851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0db10287-6867-45f1-8479-f5ea070a9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e02c62c10>]}
00:02:28.999118 [debug] [MainThread]: On master: ROLLBACK
00:02:28.999553 [debug] [MainThread]: Using postgres connection "master"
00:02:28.999705 [debug] [MainThread]: On master: BEGIN
00:02:28.999994 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:02:29.000117 [debug] [MainThread]: On master: COMMIT
00:02:29.000242 [debug] [MainThread]: Using postgres connection "master"
00:02:29.000363 [debug] [MainThread]: On master: COMMIT
00:02:29.000558 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:02:29.000702 [debug] [MainThread]: On master: Close
00:02:29.001159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:02:29.001456 [info ] [MainThread]: 
00:02:29.003921 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:02:29.004413 [info ] [Thread-1  ]: 1 of 1 START table model public.merger_model ................................... [RUN]
00:02:29.004937 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:02:29.005161 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:02:29.005328 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:02:29.008227 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:02:29.008574 [debug] [Thread-1  ]: finished collecting timing info
00:02:29.008754 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:02:29.032653 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:02:29.033116 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:02:29.033278 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:02:29.033406 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:02:29.040895 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:02:29.041330 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:02:29.041493 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."public"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."public"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."public"."campaigns_inventory" left join "trial"."public"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:02:32.267317 [debug] [Thread-1  ]: SQL status: SELECT 422791 in 3.23 seconds
00:02:32.272169 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:02:32.272326 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model__dbt_tmp" rename to "merger_model"
00:02:32.276093 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:02:32.283568 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:02:32.283695 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:02:32.283799 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:02:32.289519 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
00:02:32.292705 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:02:32.292829 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
drop table if exists "trial"."public"."merger_model__dbt_backup" cascade
00:02:32.293403 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
00:02:32.294407 [debug] [Thread-1  ]: finished collecting timing info
00:02:32.294571 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:02:32.294991 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0db10287-6867-45f1-8479-f5ea070a9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e01b16bb0>]}
00:02:32.295309 [info ] [Thread-1  ]: 1 of 1 OK created table model public.merger_model .............................. [[32mSELECT 422791[0m in 3.29s]
00:02:32.295687 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:02:32.296650 [debug] [MainThread]: Acquiring new postgres connection "master"
00:02:32.296850 [debug] [MainThread]: Using postgres connection "master"
00:02:32.296995 [debug] [MainThread]: On master: BEGIN
00:02:32.297143 [debug] [MainThread]: Opening a new connection, currently in state closed
00:02:32.309789 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:02:32.310103 [debug] [MainThread]: On master: COMMIT
00:02:32.310274 [debug] [MainThread]: Using postgres connection "master"
00:02:32.310431 [debug] [MainThread]: On master: COMMIT
00:02:32.310675 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:02:32.310859 [debug] [MainThread]: On master: Close
00:02:32.311421 [info ] [MainThread]: 
00:02:32.311768 [info ] [MainThread]: Finished running 1 table model in 3.39s.
00:02:32.312103 [debug] [MainThread]: Connection 'master' was properly closed.
00:02:32.312297 [debug] [MainThread]: Connection 'model.ad.merger_model' was properly closed.
00:02:32.316414 [info ] [MainThread]: 
00:02:32.316819 [info ] [MainThread]: [32mCompleted successfully[0m
00:02:32.317277 [info ] [MainThread]: 
00:02:32.317594 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
00:02:32.318161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e01b27730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e01b16bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e02c94760>]}


============================== 2022-08-10 00:03:26.171239 | 11e7a642-38fe-4495-98fd-f35d26cd056a ==============================
00:03:26.171254 [info ] [MainThread]: Running with dbt=1.1.1
00:03:26.171796 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:03:26.171972 [debug] [MainThread]: Tracking: tracking
00:03:26.194155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4265e83ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4265e9a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4265e9a0d0>]}
00:03:26.217502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:03:26.217789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:03:26.224166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11e7a642-38fe-4495-98fd-f35d26cd056a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4265e22670>]}
00:03:26.227815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11e7a642-38fe-4495-98fd-f35d26cd056a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4265ec5250>]}
00:03:26.228066 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:03:26.228311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11e7a642-38fe-4495-98fd-f35d26cd056a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4265ec5310>]}
00:03:26.229549 [info ] [MainThread]: 
00:03:26.230129 [debug] [MainThread]: Acquiring new postgres connection "master"
00:03:26.230919 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:03:26.240694 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:03:26.241023 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:03:26.241212 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:03:26.251003 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:03:26.251299 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:03:26.251447 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:03:26.256943 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:03:26.259784 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:03:26.260302 [debug] [ThreadPool]: On list_trial_public: Close
00:03:26.264363 [debug] [MainThread]: Using postgres connection "master"
00:03:26.264527 [debug] [MainThread]: On master: BEGIN
00:03:26.264654 [debug] [MainThread]: Opening a new connection, currently in state init
00:03:26.271887 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:03:26.272203 [debug] [MainThread]: Using postgres connection "master"
00:03:26.272393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:03:26.291672 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:03:26.293167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11e7a642-38fe-4495-98fd-f35d26cd056a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4265e0dfa0>]}
00:03:26.293450 [debug] [MainThread]: On master: ROLLBACK
00:03:26.293867 [debug] [MainThread]: On master: Close
00:03:26.294678 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:03:26.294984 [info ] [MainThread]: 
00:03:26.298440 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:03:26.298876 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:03:26.299037 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:03:26.299216 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:03:26.301858 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:03:26.302145 [debug] [Thread-1  ]: finished collecting timing info
00:03:26.302280 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:03:26.302415 [debug] [Thread-1  ]: finished collecting timing info
00:03:26.302798 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:03:26.303666 [debug] [MainThread]: Connection 'master' was properly closed.
00:03:26.303873 [debug] [MainThread]: Connection 'model.ad.merger_model' was properly closed.
00:03:26.307172 [info ] [MainThread]: Done.
00:03:26.310737 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:03:26.311094 [info ] [MainThread]: Building catalog
00:03:26.313260 [debug] [ThreadPool]: Acquiring new postgres connection "trial.information_schema"
00:03:26.320437 [debug] [ThreadPool]: Using postgres connection "trial.information_schema"
00:03:26.320717 [debug] [ThreadPool]: On trial.information_schema: BEGIN
00:03:26.320907 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:03:26.328345 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:03:26.328601 [debug] [ThreadPool]: Using postgres connection "trial.information_schema"
00:03:26.328742 [debug] [ThreadPool]: On trial.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "trial.information_schema"} */

    
    

    select
        'trial' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:03:26.338757 [debug] [ThreadPool]: SQL status: SELECT 246 in 0.01 seconds
00:03:26.357119 [debug] [ThreadPool]: On trial.information_schema: ROLLBACK
00:03:26.357544 [debug] [ThreadPool]: On trial.information_schema: Close
00:03:26.373675 [info ] [MainThread]: Catalog written to /home/hp/Downloads/pr/AD-DS-Challenge/dbt/target/catalog.json
00:03:26.374228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4265e83ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42645477f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4264547670>]}
00:03:27.594776 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:03:27.595831 [debug] [MainThread]: Connection 'trial.information_schema' was properly closed.


============================== 2022-08-10 00:11:51.655103 | 8ddec209-e744-428b-9b0e-f2b4a6499ffb ==============================
00:11:51.655118 [info ] [MainThread]: Running with dbt=1.1.1
00:11:51.655821 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
00:11:51.655984 [debug] [MainThread]: Tracking: tracking
00:11:51.687416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf10824fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf10824bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1083e070>]}
00:11:51.709231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
00:11:51.709663 [debug] [MainThread]: Partial parsing: added file: ad://models/advert/cleaner_model.sql
00:11:51.709873 [debug] [MainThread]: Partial parsing: added file: ad://models/advert/group_by_sitename.sql
00:11:51.710045 [debug] [MainThread]: Partial parsing: added file: ad://models/advert/group_by_country.sql
00:11:51.720904 [debug] [MainThread]: 1699: static parser successfully parsed advert/cleaner_model.sql
00:11:51.731285 [debug] [MainThread]: 1699: static parser successfully parsed advert/group_by_sitename.sql
00:11:51.734088 [debug] [MainThread]: 1699: static parser successfully parsed advert/group_by_country.sql
00:11:51.740686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ddec209-e744-428b-9b0e-f2b4a6499ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0f700a60>]}
00:11:51.744204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ddec209-e744-428b-9b0e-f2b4a6499ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf10773cd0>]}
00:11:51.744467 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:11:51.744717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ddec209-e744-428b-9b0e-f2b4a6499ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf10773f10>]}
00:11:51.745802 [info ] [MainThread]: 
00:11:51.746078 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
00:11:51.750618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1084bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf10773fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf10773b50>]}


============================== 2022-08-10 00:12:16.185861 | 7b558e85-668f-4862-9fe8-1709d90da70b ==============================
00:12:16.185877 [info ] [MainThread]: Running with dbt=1.1.1
00:12:16.186442 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:12:16.186578 [debug] [MainThread]: Tracking: tracking
00:12:16.207271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46add70fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46add70e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46add8c0a0>]}
00:12:16.231430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:12:16.231620 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:12:16.236077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b558e85-668f-4862-9fe8-1709d90da70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46add18ee0>]}
00:12:16.240280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b558e85-668f-4862-9fe8-1709d90da70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46add317f0>]}
00:12:16.240568 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:12:16.240824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b558e85-668f-4862-9fe8-1709d90da70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46add318e0>]}
00:12:16.242038 [info ] [MainThread]: 
00:12:16.242540 [debug] [MainThread]: Acquiring new postgres connection "master"
00:12:16.243441 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:12:16.253692 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:12:16.253965 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:12:16.254137 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:12:16.262972 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:12:16.264352 [debug] [ThreadPool]: On list_trial: Close
00:12:16.265958 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:12:16.270996 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:12:16.271281 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:12:16.271664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:12:16.279379 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:12:16.279642 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:12:16.279801 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:12:16.281950 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
00:12:16.283269 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:12:16.283895 [debug] [ThreadPool]: On list_trial_public: Close
00:12:16.288295 [debug] [MainThread]: Using postgres connection "master"
00:12:16.288491 [debug] [MainThread]: On master: BEGIN
00:12:16.288741 [debug] [MainThread]: Opening a new connection, currently in state init
00:12:16.295416 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:12:16.295609 [debug] [MainThread]: Using postgres connection "master"
00:12:16.295737 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:12:16.311214 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:12:16.312802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b558e85-668f-4862-9fe8-1709d90da70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46add31760>]}
00:12:16.313089 [debug] [MainThread]: On master: ROLLBACK
00:12:16.313485 [debug] [MainThread]: Using postgres connection "master"
00:12:16.313639 [debug] [MainThread]: On master: BEGIN
00:12:16.314189 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:12:16.314354 [debug] [MainThread]: On master: COMMIT
00:12:16.314480 [debug] [MainThread]: Using postgres connection "master"
00:12:16.314591 [debug] [MainThread]: On master: COMMIT
00:12:16.314864 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:12:16.314990 [debug] [MainThread]: On master: Close
00:12:16.315437 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:12:16.315730 [info ] [MainThread]: 
00:12:16.319017 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:12:16.319323 [info ] [Thread-1  ]: 1 of 4 START table model public.merger_model ................................... [RUN]
00:12:16.319908 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:12:16.320084 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:12:16.320245 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:12:16.323076 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:12:16.323414 [debug] [Thread-1  ]: finished collecting timing info
00:12:16.323579 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:12:16.347777 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:12:16.348275 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:12:16.348445 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:12:16.348571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:12:16.355997 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:12:16.356296 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:12:16.356452 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."public"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."public"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."public"."campaigns_inventory" left join "trial"."public"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:12:20.709901 [debug] [Thread-1  ]: SQL status: SELECT 422791 in 4.35 seconds
00:12:20.721760 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:12:20.722338 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model" rename to "merger_model__dbt_backup"
00:12:20.755770 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
00:12:20.761947 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:12:20.762371 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model__dbt_tmp" rename to "merger_model"
00:12:20.763452 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:12:20.777853 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:12:20.778050 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:12:20.778169 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:12:20.805763 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
00:12:20.813847 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:12:20.814141 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
drop table if exists "trial"."public"."merger_model__dbt_backup" cascade
00:12:20.861783 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.05 seconds
00:12:20.862892 [debug] [Thread-1  ]: finished collecting timing info
00:12:20.863106 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:12:20.863565 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b558e85-668f-4862-9fe8-1709d90da70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46adcd6c10>]}
00:12:20.863878 [info ] [Thread-1  ]: 1 of 4 OK created table model public.merger_model .............................. [[32mSELECT 422791[0m in 4.54s]
00:12:20.864268 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:12:20.864921 [debug] [Thread-1  ]: Began running node model.ad.cleaner_model
00:12:20.865203 [info ] [Thread-1  ]: 2 of 4 START table model public.cleaner_model .................................. [RUN]
00:12:20.865917 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.cleaner_model"
00:12:20.866087 [debug] [Thread-1  ]: Began compiling node model.ad.cleaner_model
00:12:20.866234 [debug] [Thread-1  ]: Compiling model.ad.cleaner_model
00:12:20.868305 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.cleaner_model"
00:12:20.868632 [debug] [Thread-1  ]: finished collecting timing info
00:12:20.868800 [debug] [Thread-1  ]: Began executing node model.ad.cleaner_model
00:12:20.871246 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.cleaner_model"
00:12:20.871576 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:12:20.871729 [debug] [Thread-1  ]: On model.ad.cleaner_model: BEGIN
00:12:20.871857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:12:20.884504 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:12:20.884748 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:12:20.884878 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */


  create  table "trial"."public"."cleaner_model__dbt_tmp"
  as (
    
select *
from "trial"."public"."merger_model"
where row_num == 1
  );
00:12:20.885947 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: bigint == integer
LINE 9: where row_num == 1
                      ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

00:12:20.886213 [debug] [Thread-1  ]: On model.ad.cleaner_model: ROLLBACK
00:12:20.886625 [debug] [Thread-1  ]: finished collecting timing info
00:12:20.886928 [debug] [Thread-1  ]: On model.ad.cleaner_model: Close
00:12:20.887639 [debug] [Thread-1  ]: Database Error in model cleaner_model (models/advert/cleaner_model.sql)
  operator does not exist: bigint == integer
  LINE 9: where row_num == 1
                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/ad/models/advert/cleaner_model.sql
00:12:20.888065 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b558e85-668f-4862-9fe8-1709d90da70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46adcd0760>]}
00:12:20.888445 [error] [Thread-1  ]: 2 of 4 ERROR creating table model public.cleaner_model ......................... [[31mERROR[0m in 0.02s]
00:12:20.888900 [debug] [Thread-1  ]: Finished running node model.ad.cleaner_model
00:12:20.889989 [debug] [Thread-1  ]: Began running node model.ad.group_by_country
00:12:20.890234 [info ] [Thread-1  ]: 3 of 4 SKIP relation public.group_by_country ................................... [[33mSKIP[0m]
00:12:20.890774 [debug] [Thread-1  ]: Finished running node model.ad.group_by_country
00:12:20.891063 [debug] [Thread-1  ]: Began running node model.ad.group_by_sitename
00:12:20.891343 [info ] [Thread-1  ]: 4 of 4 SKIP relation public.group_by_sitename .................................. [[33mSKIP[0m]
00:12:20.891695 [debug] [Thread-1  ]: Finished running node model.ad.group_by_sitename
00:12:20.892770 [debug] [MainThread]: Acquiring new postgres connection "master"
00:12:20.893009 [debug] [MainThread]: Using postgres connection "master"
00:12:20.893274 [debug] [MainThread]: On master: BEGIN
00:12:20.893420 [debug] [MainThread]: Opening a new connection, currently in state closed
00:12:20.901317 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:12:20.901580 [debug] [MainThread]: On master: COMMIT
00:12:20.901736 [debug] [MainThread]: Using postgres connection "master"
00:12:20.901872 [debug] [MainThread]: On master: COMMIT
00:12:20.902100 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:12:20.902254 [debug] [MainThread]: On master: Close
00:12:20.902755 [info ] [MainThread]: 
00:12:20.903063 [info ] [MainThread]: Finished running 2 table models, 2 view models in 4.66s.
00:12:20.903389 [debug] [MainThread]: Connection 'master' was properly closed.
00:12:20.903603 [debug] [MainThread]: Connection 'model.ad.cleaner_model' was properly closed.
00:12:20.907806 [info ] [MainThread]: 
00:12:20.908118 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:12:20.908483 [info ] [MainThread]: 
00:12:20.908932 [error] [MainThread]: [33mDatabase Error in model cleaner_model (models/advert/cleaner_model.sql)[0m
00:12:20.909408 [error] [MainThread]:   operator does not exist: bigint == integer
00:12:20.909696 [error] [MainThread]:   LINE 9: where row_num == 1
00:12:20.910127 [error] [MainThread]:                         ^
00:12:20.910490 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
00:12:20.910790 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/cleaner_model.sql
00:12:20.911101 [info ] [MainThread]: 
00:12:20.911419 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
00:12:20.911851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46ad478a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46ad478be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46add31430>]}


============================== 2022-08-10 00:13:58.239555 | 42c05449-0d0d-48a1-80b5-94a27c01b46c ==============================
00:13:58.239570 [info ] [MainThread]: Running with dbt=1.1.1
00:13:58.240070 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:13:58.240215 [debug] [MainThread]: Tracking: tracking
00:13:58.264937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ccf92f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ccf92fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ccfa7070>]}
00:13:58.293885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:13:58.294246 [debug] [MainThread]: Partial parsing: updated file: ad://models/advert/cleaner_model.sql
00:13:58.304679 [debug] [MainThread]: 1699: static parser successfully parsed advert/cleaner_model.sql
00:13:58.319255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42c05449-0d0d-48a1-80b5-94a27c01b46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3cceb9940>]}
00:13:58.322656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42c05449-0d0d-48a1-80b5-94a27c01b46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ccedcbb0>]}
00:13:58.322925 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:13:58.323183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c05449-0d0d-48a1-80b5-94a27c01b46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ccff4be0>]}
00:13:58.324393 [info ] [MainThread]: 
00:13:58.324870 [debug] [MainThread]: Acquiring new postgres connection "master"
00:13:58.325844 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:13:58.334564 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:13:58.334831 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:13:58.334992 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:13:58.345160 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:13:58.346611 [debug] [ThreadPool]: On list_trial: Close
00:13:58.347838 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:13:58.352525 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:13:58.352942 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:13:58.353073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:13:58.361544 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:13:58.361837 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:13:58.362009 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:13:58.367784 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:13:58.369104 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:13:58.369367 [debug] [ThreadPool]: On list_trial_public: Close
00:13:58.373987 [debug] [MainThread]: Using postgres connection "master"
00:13:58.374174 [debug] [MainThread]: On master: BEGIN
00:13:58.374298 [debug] [MainThread]: Opening a new connection, currently in state init
00:13:58.381442 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:13:58.381637 [debug] [MainThread]: Using postgres connection "master"
00:13:58.381765 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:13:58.399674 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:13:58.400945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c05449-0d0d-48a1-80b5-94a27c01b46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ccedcf40>]}
00:13:58.401212 [debug] [MainThread]: On master: ROLLBACK
00:13:58.401598 [debug] [MainThread]: Using postgres connection "master"
00:13:58.401750 [debug] [MainThread]: On master: BEGIN
00:13:58.402286 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:13:58.402456 [debug] [MainThread]: On master: COMMIT
00:13:58.402599 [debug] [MainThread]: Using postgres connection "master"
00:13:58.402735 [debug] [MainThread]: On master: COMMIT
00:13:58.403025 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:13:58.403215 [debug] [MainThread]: On master: Close
00:13:58.403670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:13:58.403969 [info ] [MainThread]: 
00:13:58.407171 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:13:58.407505 [info ] [Thread-1  ]: 1 of 4 START table model public.merger_model ................................... [RUN]
00:13:58.408071 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:13:58.408264 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:13:58.408435 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:13:58.411378 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:13:58.411730 [debug] [Thread-1  ]: finished collecting timing info
00:13:58.411906 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:13:58.439236 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:13:58.439641 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:13:58.439808 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:13:58.439937 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:13:58.447607 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:13:58.447841 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:13:58.447971 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."public"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."public"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."public"."campaigns_inventory" left join "trial"."public"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:14:04.179849 [debug] [Thread-1  ]: SQL status: SELECT 422791 in 5.73 seconds
00:14:04.184240 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:14:04.184393 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model" rename to "merger_model__dbt_backup"
00:14:04.188024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:14:04.189655 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:14:04.189775 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model__dbt_tmp" rename to "merger_model"
00:14:04.190840 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:14:04.197731 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:14:04.197872 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:14:04.197981 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:14:04.199673 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:14:04.202902 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:14:04.203019 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
drop table if exists "trial"."public"."merger_model__dbt_backup" cascade
00:14:04.253181 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.05 seconds
00:14:04.254703 [debug] [Thread-1  ]: finished collecting timing info
00:14:04.254984 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:14:04.255714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c05449-0d0d-48a1-80b5-94a27c01b46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c75f4a60>]}
00:14:04.256158 [info ] [Thread-1  ]: 1 of 4 OK created table model public.merger_model .............................. [[32mSELECT 422791[0m in 5.85s]
00:14:04.256621 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:14:04.257367 [debug] [Thread-1  ]: Began running node model.ad.cleaner_model
00:14:04.257629 [info ] [Thread-1  ]: 2 of 4 START table model public.cleaner_model .................................. [RUN]
00:14:04.258117 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.cleaner_model"
00:14:04.258359 [debug] [Thread-1  ]: Began compiling node model.ad.cleaner_model
00:14:04.258614 [debug] [Thread-1  ]: Compiling model.ad.cleaner_model
00:14:04.262131 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.cleaner_model"
00:14:04.262666 [debug] [Thread-1  ]: finished collecting timing info
00:14:04.262982 [debug] [Thread-1  ]: Began executing node model.ad.cleaner_model
00:14:04.266538 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.cleaner_model"
00:14:04.266937 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:14:04.267148 [debug] [Thread-1  ]: On model.ad.cleaner_model: BEGIN
00:14:04.267351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:14:04.280106 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:14:04.280631 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:14:04.280919 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */


  create  table "trial"."public"."cleaner_model__dbt_tmp"
  as (
    
select *
from "trial"."public"."merger_model"
where row_num is 1
  );
00:14:04.281514 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "1"
LINE 9: where row_num is 1
                         ^

00:14:04.281752 [debug] [Thread-1  ]: On model.ad.cleaner_model: ROLLBACK
00:14:04.282160 [debug] [Thread-1  ]: finished collecting timing info
00:14:04.282337 [debug] [Thread-1  ]: On model.ad.cleaner_model: Close
00:14:04.282810 [debug] [Thread-1  ]: Database Error in model cleaner_model (models/advert/cleaner_model.sql)
  syntax error at or near "1"
  LINE 9: where row_num is 1
                           ^
  compiled SQL at target/run/ad/models/advert/cleaner_model.sql
00:14:04.283230 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c05449-0d0d-48a1-80b5-94a27c01b46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c5d639d0>]}
00:14:04.283591 [error] [Thread-1  ]: 2 of 4 ERROR creating table model public.cleaner_model ......................... [[31mERROR[0m in 0.03s]
00:14:04.284022 [debug] [Thread-1  ]: Finished running node model.ad.cleaner_model
00:14:04.284679 [debug] [Thread-1  ]: Began running node model.ad.group_by_country
00:14:04.284873 [info ] [Thread-1  ]: 3 of 4 SKIP relation public.group_by_country ................................... [[33mSKIP[0m]
00:14:04.285833 [debug] [Thread-1  ]: Finished running node model.ad.group_by_country
00:14:04.286153 [debug] [Thread-1  ]: Began running node model.ad.group_by_sitename
00:14:04.286467 [info ] [Thread-1  ]: 4 of 4 SKIP relation public.group_by_sitename .................................. [[33mSKIP[0m]
00:14:04.286823 [debug] [Thread-1  ]: Finished running node model.ad.group_by_sitename
00:14:04.287649 [debug] [MainThread]: Acquiring new postgres connection "master"
00:14:04.287865 [debug] [MainThread]: Using postgres connection "master"
00:14:04.288022 [debug] [MainThread]: On master: BEGIN
00:14:04.288162 [debug] [MainThread]: Opening a new connection, currently in state closed
00:14:04.296619 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:14:04.296907 [debug] [MainThread]: On master: COMMIT
00:14:04.297053 [debug] [MainThread]: Using postgres connection "master"
00:14:04.297200 [debug] [MainThread]: On master: COMMIT
00:14:04.297413 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:14:04.297584 [debug] [MainThread]: On master: Close
00:14:04.298116 [info ] [MainThread]: 
00:14:04.298460 [info ] [MainThread]: Finished running 2 table models, 2 view models in 5.97s.
00:14:04.298708 [debug] [MainThread]: Connection 'master' was properly closed.
00:14:04.298838 [debug] [MainThread]: Connection 'model.ad.cleaner_model' was properly closed.
00:14:04.302552 [info ] [MainThread]: 
00:14:04.302836 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:14:04.303084 [info ] [MainThread]: 
00:14:04.303290 [error] [MainThread]: [33mDatabase Error in model cleaner_model (models/advert/cleaner_model.sql)[0m
00:14:04.303496 [error] [MainThread]:   syntax error at or near "1"
00:14:04.303722 [error] [MainThread]:   LINE 9: where row_num is 1
00:14:04.303962 [error] [MainThread]:                            ^
00:14:04.304200 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/cleaner_model.sql
00:14:04.304462 [info ] [MainThread]: 
00:14:04.304723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
00:14:04.305356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c75f4a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ccedcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3cd001ee0>]}


============================== 2022-08-10 00:14:16.671729 | b5413787-b5fc-40e8-8e32-2d4510793864 ==============================
00:14:16.671746 [info ] [MainThread]: Running with dbt=1.1.1
00:14:16.672291 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:14:16.672429 [debug] [MainThread]: Tracking: tracking
00:14:16.695882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1614045f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1614045e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1614045ca0>]}
00:14:16.722907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:14:16.723254 [debug] [MainThread]: Partial parsing: updated file: ad://models/advert/cleaner_model.sql
00:14:16.734318 [debug] [MainThread]: 1699: static parser successfully parsed advert/cleaner_model.sql
00:14:16.748553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5413787-b5fc-40e8-8e32-2d4510793864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1613fb28e0>]}
00:14:16.751660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5413787-b5fc-40e8-8e32-2d4510793864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161406c6a0>]}
00:14:16.751928 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:14:16.752171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5413787-b5fc-40e8-8e32-2d4510793864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16140ccb80>]}
00:14:16.753370 [info ] [MainThread]: 
00:14:16.753907 [debug] [MainThread]: Acquiring new postgres connection "master"
00:14:16.755249 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:14:16.764823 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:14:16.765097 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:14:16.765259 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:14:16.779598 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:14:16.781068 [debug] [ThreadPool]: On list_trial: Close
00:14:16.782872 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:14:16.787937 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:14:16.788087 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:14:16.788194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:14:16.796644 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:14:16.796901 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:14:16.797228 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:14:16.802850 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:14:16.804133 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:14:16.804406 [debug] [ThreadPool]: On list_trial_public: Close
00:14:16.810752 [debug] [MainThread]: Using postgres connection "master"
00:14:16.811043 [debug] [MainThread]: On master: BEGIN
00:14:16.811249 [debug] [MainThread]: Opening a new connection, currently in state init
00:14:16.819915 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:14:16.820153 [debug] [MainThread]: Using postgres connection "master"
00:14:16.820290 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:14:16.858346 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
00:14:16.859935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5413787-b5fc-40e8-8e32-2d4510793864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1612f717f0>]}
00:14:16.860213 [debug] [MainThread]: On master: ROLLBACK
00:14:16.860498 [debug] [MainThread]: Using postgres connection "master"
00:14:16.860635 [debug] [MainThread]: On master: BEGIN
00:14:16.860901 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:14:16.861053 [debug] [MainThread]: On master: COMMIT
00:14:16.861196 [debug] [MainThread]: Using postgres connection "master"
00:14:16.861336 [debug] [MainThread]: On master: COMMIT
00:14:16.861630 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:14:16.861825 [debug] [MainThread]: On master: Close
00:14:16.862317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:14:16.862583 [info ] [MainThread]: 
00:14:16.865131 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:14:16.865560 [info ] [Thread-1  ]: 1 of 4 START table model public.merger_model ................................... [RUN]
00:14:16.866063 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:14:16.866291 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:14:16.866489 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:14:16.869455 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:14:16.869824 [debug] [Thread-1  ]: finished collecting timing info
00:14:16.870024 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:14:16.894426 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:14:16.894924 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:14:16.895089 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:14:16.895201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:14:16.903759 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:14:16.904054 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:14:16.904215 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."public"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."public"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."public"."campaigns_inventory" left join "trial"."public"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:14:20.446453 [debug] [Thread-1  ]: SQL status: SELECT 422791 in 3.54 seconds
00:14:20.451089 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:14:20.451240 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model" rename to "merger_model__dbt_backup"
00:14:21.304743 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.85 seconds
00:14:21.309603 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:14:21.309982 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model__dbt_tmp" rename to "merger_model"
00:14:21.310617 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:14:21.322563 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:14:21.322736 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:14:21.322859 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:14:21.324277 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:14:21.328304 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:14:21.328487 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
drop table if exists "trial"."public"."merger_model__dbt_backup" cascade
00:14:22.359651 [debug] [Thread-1  ]: SQL status: DROP TABLE in 1.03 seconds
00:14:22.360974 [debug] [Thread-1  ]: finished collecting timing info
00:14:22.361220 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:14:22.361697 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5413787-b5fc-40e8-8e32-2d4510793864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161272aa00>]}
00:14:22.362042 [info ] [Thread-1  ]: 1 of 4 OK created table model public.merger_model .............................. [[32mSELECT 422791[0m in 5.50s]
00:14:22.362450 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:14:22.363345 [debug] [Thread-1  ]: Began running node model.ad.cleaner_model
00:14:22.363641 [info ] [Thread-1  ]: 2 of 4 START table model public.cleaner_model .................................. [RUN]
00:14:22.364143 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.cleaner_model"
00:14:22.364364 [debug] [Thread-1  ]: Began compiling node model.ad.cleaner_model
00:14:22.364522 [debug] [Thread-1  ]: Compiling model.ad.cleaner_model
00:14:22.366596 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.cleaner_model"
00:14:22.366968 [debug] [Thread-1  ]: finished collecting timing info
00:14:22.367144 [debug] [Thread-1  ]: Began executing node model.ad.cleaner_model
00:14:22.369485 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.cleaner_model"
00:14:22.369815 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:14:22.369955 [debug] [Thread-1  ]: On model.ad.cleaner_model: BEGIN
00:14:22.370084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:14:22.378415 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:14:22.378781 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:14:22.378974 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */


  create  table "trial"."public"."cleaner_model__dbt_tmp"
  as (
    
select *
from "trial"."public"."merger_model"
where row_num is "1"
  );
00:14:22.379322 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ""1""
LINE 9: where row_num is "1"
                         ^

00:14:22.379528 [debug] [Thread-1  ]: On model.ad.cleaner_model: ROLLBACK
00:14:22.379891 [debug] [Thread-1  ]: finished collecting timing info
00:14:22.380073 [debug] [Thread-1  ]: On model.ad.cleaner_model: Close
00:14:22.380669 [debug] [Thread-1  ]: Database Error in model cleaner_model (models/advert/cleaner_model.sql)
  syntax error at or near ""1""
  LINE 9: where row_num is "1"
                           ^
  compiled SQL at target/run/ad/models/advert/cleaner_model.sql
00:14:22.381004 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5413787-b5fc-40e8-8e32-2d4510793864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1610e8afa0>]}
00:14:22.381465 [error] [Thread-1  ]: 2 of 4 ERROR creating table model public.cleaner_model ......................... [[31mERROR[0m in 0.02s]
00:14:22.381977 [debug] [Thread-1  ]: Finished running node model.ad.cleaner_model
00:14:22.382854 [debug] [Thread-1  ]: Began running node model.ad.group_by_country
00:14:22.383083 [info ] [Thread-1  ]: 3 of 4 SKIP relation public.group_by_country ................................... [[33mSKIP[0m]
00:14:22.383645 [debug] [Thread-1  ]: Finished running node model.ad.group_by_country
00:14:22.383921 [debug] [Thread-1  ]: Began running node model.ad.group_by_sitename
00:14:22.384162 [info ] [Thread-1  ]: 4 of 4 SKIP relation public.group_by_sitename .................................. [[33mSKIP[0m]
00:14:22.384542 [debug] [Thread-1  ]: Finished running node model.ad.group_by_sitename
00:14:22.385542 [debug] [MainThread]: Acquiring new postgres connection "master"
00:14:22.385773 [debug] [MainThread]: Using postgres connection "master"
00:14:22.386159 [debug] [MainThread]: On master: BEGIN
00:14:22.386436 [debug] [MainThread]: Opening a new connection, currently in state closed
00:14:22.393043 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:14:22.393245 [debug] [MainThread]: On master: COMMIT
00:14:22.393374 [debug] [MainThread]: Using postgres connection "master"
00:14:22.393475 [debug] [MainThread]: On master: COMMIT
00:14:22.393645 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:14:22.393785 [debug] [MainThread]: On master: Close
00:14:22.394357 [info ] [MainThread]: 
00:14:22.394744 [info ] [MainThread]: Finished running 2 table models, 2 view models in 5.64s.
00:14:22.395055 [debug] [MainThread]: Connection 'master' was properly closed.
00:14:22.395209 [debug] [MainThread]: Connection 'model.ad.cleaner_model' was properly closed.
00:14:22.399428 [info ] [MainThread]: 
00:14:22.399792 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:14:22.400092 [info ] [MainThread]: 
00:14:22.400356 [error] [MainThread]: [33mDatabase Error in model cleaner_model (models/advert/cleaner_model.sql)[0m
00:14:22.400639 [error] [MainThread]:   syntax error at or near ""1""
00:14:22.400900 [error] [MainThread]:   LINE 9: where row_num is "1"
00:14:22.401327 [error] [MainThread]:                            ^
00:14:22.401579 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/cleaner_model.sql
00:14:22.401842 [info ] [MainThread]: 
00:14:22.402095 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
00:14:22.402439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16140f5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16140e3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1612714e50>]}


============================== 2022-08-10 00:15:30.438414 | 5bc838ae-8535-4d6a-a494-7db2588488fd ==============================
00:15:30.438433 [info ] [MainThread]: Running with dbt=1.1.1
00:15:30.438980 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:15:30.439217 [debug] [MainThread]: Tracking: tracking
00:15:30.460369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a629afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a629ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a62b6040>]}
00:15:30.486113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:15:30.486692 [debug] [MainThread]: Partial parsing: updated file: ad://models/advert/cleaner_model.sql
00:15:30.498959 [debug] [MainThread]: 1699: static parser successfully parsed advert/cleaner_model.sql
00:15:30.515604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bc838ae-8535-4d6a-a494-7db2588488fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a61cc910>]}
00:15:30.519291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bc838ae-8535-4d6a-a494-7db2588488fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a61f0fa0>]}
00:15:30.519566 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:15:30.519830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc838ae-8535-4d6a-a494-7db2588488fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a62ffbb0>]}
00:15:30.520925 [info ] [MainThread]: 
00:15:30.521445 [debug] [MainThread]: Acquiring new postgres connection "master"
00:15:30.522331 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:15:30.532725 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:15:30.532995 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:15:30.533187 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:15:30.546623 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:15:30.548433 [debug] [ThreadPool]: On list_trial: Close
00:15:30.549970 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:15:30.556555 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:15:30.556775 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:15:30.556934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:15:30.565153 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:15:30.565582 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:15:30.565744 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:15:30.568264 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
00:15:30.569910 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:15:30.570198 [debug] [ThreadPool]: On list_trial_public: Close
00:15:30.574687 [debug] [MainThread]: Using postgres connection "master"
00:15:30.574857 [debug] [MainThread]: On master: BEGIN
00:15:30.574977 [debug] [MainThread]: Opening a new connection, currently in state init
00:15:30.583094 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:15:30.583329 [debug] [MainThread]: Using postgres connection "master"
00:15:30.583464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:15:30.599553 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:15:30.600957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc838ae-8535-4d6a-a494-7db2588488fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a5187880>]}
00:15:30.601277 [debug] [MainThread]: On master: ROLLBACK
00:15:30.601581 [debug] [MainThread]: Using postgres connection "master"
00:15:30.601744 [debug] [MainThread]: On master: BEGIN
00:15:30.602202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:15:30.602406 [debug] [MainThread]: On master: COMMIT
00:15:30.602548 [debug] [MainThread]: Using postgres connection "master"
00:15:30.602679 [debug] [MainThread]: On master: COMMIT
00:15:30.602991 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:15:30.603197 [debug] [MainThread]: On master: Close
00:15:30.603685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:15:30.603968 [info ] [MainThread]: 
00:15:30.607228 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:15:30.607800 [info ] [Thread-1  ]: 1 of 4 START table model public.merger_model ................................... [RUN]
00:15:30.608354 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:15:30.608555 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:15:30.608724 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:15:30.611722 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:15:30.612103 [debug] [Thread-1  ]: finished collecting timing info
00:15:30.612300 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:15:30.638829 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:15:30.639291 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:15:30.639496 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:15:30.639666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:15:30.646731 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:15:30.646956 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:15:30.647095 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."public"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."public"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."public"."campaigns_inventory" left join "trial"."public"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:15:34.477610 [debug] [Thread-1  ]: SQL status: SELECT 422791 in 3.83 seconds
00:15:34.482080 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:15:34.482217 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model" rename to "merger_model__dbt_backup"
00:15:34.483050 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:15:34.484501 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:15:34.484616 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model__dbt_tmp" rename to "merger_model"
00:15:34.484953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:15:34.491238 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:15:34.491360 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:15:34.491456 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:15:34.500531 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
00:15:34.504363 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:15:34.504537 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
drop table if exists "trial"."public"."merger_model__dbt_backup" cascade
00:15:34.542777 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
00:15:34.544116 [debug] [Thread-1  ]: finished collecting timing info
00:15:34.544326 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:15:34.544764 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bc838ae-8535-4d6a-a494-7db2588488fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a4930eb0>]}
00:15:34.545125 [info ] [Thread-1  ]: 1 of 4 OK created table model public.merger_model .............................. [[32mSELECT 422791[0m in 3.94s]
00:15:34.545530 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:15:34.546326 [debug] [Thread-1  ]: Began running node model.ad.cleaner_model
00:15:34.546638 [info ] [Thread-1  ]: 2 of 4 START table model public.cleaner_model .................................. [RUN]
00:15:34.547118 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.cleaner_model"
00:15:34.547267 [debug] [Thread-1  ]: Began compiling node model.ad.cleaner_model
00:15:34.547430 [debug] [Thread-1  ]: Compiling model.ad.cleaner_model
00:15:34.549646 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.cleaner_model"
00:15:34.550023 [debug] [Thread-1  ]: finished collecting timing info
00:15:34.550200 [debug] [Thread-1  ]: Began executing node model.ad.cleaner_model
00:15:34.552505 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.cleaner_model"
00:15:34.552801 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:15:34.552936 [debug] [Thread-1  ]: On model.ad.cleaner_model: BEGIN
00:15:34.553062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:15:34.563575 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:15:34.563886 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:15:34.564040 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */


  create  table "trial"."public"."cleaner_model__dbt_tmp"
  as (
    
select *
from "trial"."public"."merger_model"
where row_num = 1
  );
00:15:38.061541 [debug] [Thread-1  ]: SQL status: SELECT 422387 in 3.5 seconds
00:15:38.063244 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:15:38.063400 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
alter table "trial"."public"."cleaner_model__dbt_tmp" rename to "cleaner_model"
00:15:38.063803 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:15:38.064891 [debug] [Thread-1  ]: On model.ad.cleaner_model: COMMIT
00:15:38.065003 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:15:38.065100 [debug] [Thread-1  ]: On model.ad.cleaner_model: COMMIT
00:15:38.069570 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:15:38.070986 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:15:38.071101 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
drop table if exists "trial"."public"."cleaner_model__dbt_backup" cascade
00:15:38.071355 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
00:15:38.072098 [debug] [Thread-1  ]: finished collecting timing info
00:15:38.072246 [debug] [Thread-1  ]: On model.ad.cleaner_model: Close
00:15:38.072755 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bc838ae-8535-4d6a-a494-7db2588488fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a5184610>]}
00:15:38.073199 [info ] [Thread-1  ]: 2 of 4 OK created table model public.cleaner_model ............................. [[32mSELECT 422387[0m in 3.53s]
00:15:38.073743 [debug] [Thread-1  ]: Finished running node model.ad.cleaner_model
00:15:38.074565 [debug] [Thread-1  ]: Began running node model.ad.group_by_country
00:15:38.074917 [info ] [Thread-1  ]: 3 of 4 START view model public.group_by_country ................................ [RUN]
00:15:38.075543 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.group_by_country"
00:15:38.075745 [debug] [Thread-1  ]: Began compiling node model.ad.group_by_country
00:15:38.075958 [debug] [Thread-1  ]: Compiling model.ad.group_by_country
00:15:38.079045 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.group_by_country"
00:15:38.079393 [debug] [Thread-1  ]: finished collecting timing info
00:15:38.079548 [debug] [Thread-1  ]: Began executing node model.ad.group_by_country
00:15:38.100151 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.group_by_country"
00:15:38.100614 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:15:38.100805 [debug] [Thread-1  ]: On model.ad.group_by_country: BEGIN
00:15:38.100954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:15:38.108610 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:15:38.108839 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:15:38.108986 [debug] [Thread-1  ]: On model.ad.group_by_country: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_country"} */

  create view "trial"."public"."group_by_country__dbt_tmp" as (
    

select * , count(id)
from "trial"."public"."cleaner_model"
group by "geo_country"
  );
00:15:38.109741 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id" does not exist
LINE 6: select * , count(id)
                         ^

00:15:38.109921 [debug] [Thread-1  ]: On model.ad.group_by_country: ROLLBACK
00:15:38.110299 [debug] [Thread-1  ]: finished collecting timing info
00:15:38.110447 [debug] [Thread-1  ]: On model.ad.group_by_country: Close
00:15:38.110844 [debug] [Thread-1  ]: Database Error in model group_by_country (models/advert/group_by_country.sql)
  column "id" does not exist
  LINE 6: select * , count(id)
                           ^
  compiled SQL at target/run/ad/models/advert/group_by_country.sql
00:15:38.111101 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bc838ae-8535-4d6a-a494-7db2588488fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a40a5fa0>]}
00:15:38.111422 [error] [Thread-1  ]: 3 of 4 ERROR creating view model public.group_by_country ....................... [[31mERROR[0m in 0.04s]
00:15:38.111867 [debug] [Thread-1  ]: Finished running node model.ad.group_by_country
00:15:38.112114 [debug] [Thread-1  ]: Began running node model.ad.group_by_sitename
00:15:38.112487 [info ] [Thread-1  ]: 4 of 4 START view model public.group_by_sitename ............................... [RUN]
00:15:38.113020 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.group_by_sitename"
00:15:38.113205 [debug] [Thread-1  ]: Began compiling node model.ad.group_by_sitename
00:15:38.113345 [debug] [Thread-1  ]: Compiling model.ad.group_by_sitename
00:15:38.116314 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.group_by_sitename"
00:15:38.116670 [debug] [Thread-1  ]: finished collecting timing info
00:15:38.116847 [debug] [Thread-1  ]: Began executing node model.ad.group_by_sitename
00:15:38.119483 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.group_by_sitename"
00:15:38.119908 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:15:38.120081 [debug] [Thread-1  ]: On model.ad.group_by_sitename: BEGIN
00:15:38.120212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:15:38.127571 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:15:38.127799 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:15:38.127926 [debug] [Thread-1  ]: On model.ad.group_by_sitename: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_sitename"} */

  create view "trial"."public"."group_by_sitename__dbt_tmp" as (
    

select * , count(id)
from "trial"."public"."cleaner_model"
group by "site_name"
  );
00:15:38.128522 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id" does not exist
LINE 6: select * , count(id)
                         ^

00:15:38.128676 [debug] [Thread-1  ]: On model.ad.group_by_sitename: ROLLBACK
00:15:38.128993 [debug] [Thread-1  ]: finished collecting timing info
00:15:38.129179 [debug] [Thread-1  ]: On model.ad.group_by_sitename: Close
00:15:38.129593 [debug] [Thread-1  ]: Database Error in model group_by_sitename (models/advert/group_by_sitename.sql)
  column "id" does not exist
  LINE 6: select * , count(id)
                           ^
  compiled SQL at target/run/ad/models/advert/group_by_sitename.sql
00:15:38.129847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bc838ae-8535-4d6a-a494-7db2588488fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a493dc70>]}
00:15:38.130147 [error] [Thread-1  ]: 4 of 4 ERROR creating view model public.group_by_sitename ...................... [[31mERROR[0m in 0.02s]
00:15:38.130517 [debug] [Thread-1  ]: Finished running node model.ad.group_by_sitename
00:15:38.131500 [debug] [MainThread]: Acquiring new postgres connection "master"
00:15:38.131699 [debug] [MainThread]: Using postgres connection "master"
00:15:38.131842 [debug] [MainThread]: On master: BEGIN
00:15:38.131969 [debug] [MainThread]: Opening a new connection, currently in state closed
00:15:38.140478 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:15:38.140911 [debug] [MainThread]: On master: COMMIT
00:15:38.141105 [debug] [MainThread]: Using postgres connection "master"
00:15:38.141259 [debug] [MainThread]: On master: COMMIT
00:15:38.141644 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:15:38.141863 [debug] [MainThread]: On master: Close
00:15:38.142388 [info ] [MainThread]: 
00:15:38.142689 [info ] [MainThread]: Finished running 2 table models, 2 view models in 7.62s.
00:15:38.143031 [debug] [MainThread]: Connection 'master' was properly closed.
00:15:38.143267 [debug] [MainThread]: Connection 'model.ad.group_by_sitename' was properly closed.
00:15:38.147132 [info ] [MainThread]: 
00:15:38.147406 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
00:15:38.147711 [info ] [MainThread]: 
00:15:38.148024 [error] [MainThread]: [33mDatabase Error in model group_by_country (models/advert/group_by_country.sql)[0m
00:15:38.148297 [error] [MainThread]:   column "id" does not exist
00:15:38.148588 [error] [MainThread]:   LINE 6: select * , count(id)
00:15:38.148874 [error] [MainThread]:                            ^
00:15:38.149307 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/group_by_country.sql
00:15:38.149572 [info ] [MainThread]: 
00:15:38.149891 [error] [MainThread]: [33mDatabase Error in model group_by_sitename (models/advert/group_by_sitename.sql)[0m
00:15:38.150177 [error] [MainThread]:   column "id" does not exist
00:15:38.150549 [error] [MainThread]:   LINE 6: select * , count(id)
00:15:38.150923 [error] [MainThread]:                            ^
00:15:38.151594 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/group_by_sitename.sql
00:15:38.151875 [info ] [MainThread]: 
00:15:38.152207 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
00:15:38.152559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a62ffb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a6313340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2a4053be0>]}


============================== 2022-08-10 00:16:03.202246 | 1ba651f5-1f35-4cef-89de-b6ce3b2ce83c ==============================
00:16:03.202262 [info ] [MainThread]: Running with dbt=1.1.1
00:16:03.202780 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:16:03.202957 [debug] [MainThread]: Tracking: tracking
00:16:03.224633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e5f70f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e5f70fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e5f8b070>]}
00:16:03.248942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
00:16:03.249582 [debug] [MainThread]: Partial parsing: updated file: ad://models/advert/group_by_sitename.sql
00:16:03.249859 [debug] [MainThread]: Partial parsing: updated file: ad://models/advert/group_by_country.sql
00:16:03.261116 [debug] [MainThread]: 1699: static parser successfully parsed advert/group_by_sitename.sql
00:16:03.270863 [debug] [MainThread]: 1699: static parser successfully parsed advert/group_by_country.sql
00:16:03.277454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ba651f5-1f35-4cef-89de-b6ce3b2ce83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e4e88fa0>]}
00:16:03.280519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ba651f5-1f35-4cef-89de-b6ce3b2ce83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e5f00fd0>]}
00:16:03.280756 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:16:03.280997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba651f5-1f35-4cef-89de-b6ce3b2ce83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e6011490>]}
00:16:03.282125 [info ] [MainThread]: 
00:16:03.282592 [debug] [MainThread]: Acquiring new postgres connection "master"
00:16:03.283481 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:16:03.290942 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:16:03.291146 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:16:03.291289 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:16:03.301436 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:16:03.303164 [debug] [ThreadPool]: On list_trial: Close
00:16:03.304955 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:16:03.311484 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:16:03.311688 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:16:03.311814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:16:03.319642 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:16:03.319993 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:16:03.320221 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:16:03.322448 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
00:16:03.324250 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:16:03.324647 [debug] [ThreadPool]: On list_trial_public: Close
00:16:03.329268 [debug] [MainThread]: Using postgres connection "master"
00:16:03.329547 [debug] [MainThread]: On master: BEGIN
00:16:03.329711 [debug] [MainThread]: Opening a new connection, currently in state init
00:16:03.337981 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:16:03.338218 [debug] [MainThread]: Using postgres connection "master"
00:16:03.338378 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:16:03.353888 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:16:03.355024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba651f5-1f35-4cef-89de-b6ce3b2ce83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e5f96fd0>]}
00:16:03.355547 [debug] [MainThread]: On master: ROLLBACK
00:16:03.355809 [debug] [MainThread]: Using postgres connection "master"
00:16:03.355939 [debug] [MainThread]: On master: BEGIN
00:16:03.356202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:16:03.356335 [debug] [MainThread]: On master: COMMIT
00:16:03.356465 [debug] [MainThread]: Using postgres connection "master"
00:16:03.356584 [debug] [MainThread]: On master: COMMIT
00:16:03.356766 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:16:03.356905 [debug] [MainThread]: On master: Close
00:16:03.357345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:16:03.357630 [info ] [MainThread]: 
00:16:03.360277 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:16:03.360591 [info ] [Thread-1  ]: 1 of 4 START table model public.merger_model ................................... [RUN]
00:16:03.361113 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:16:03.361313 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:16:03.361476 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:16:03.364221 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:16:03.364520 [debug] [Thread-1  ]: finished collecting timing info
00:16:03.364699 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:16:03.388490 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:16:03.388896 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:16:03.389057 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:16:03.389190 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:16:03.397836 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:16:03.398115 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:16:03.398284 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."public"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."public"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."public"."campaigns_inventory" left join "trial"."public"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:16:10.488378 [debug] [Thread-1  ]: SQL status: SELECT 422791 in 7.09 seconds
00:16:10.494447 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:16:10.494665 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model" rename to "merger_model__dbt_backup"
00:16:11.496549 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 1.0 seconds
00:16:11.501374 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:16:11.501775 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model__dbt_tmp" rename to "merger_model"
00:16:11.502497 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:16:11.512865 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:16:11.513122 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:16:11.513304 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:16:11.515113 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:16:11.518194 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:16:11.518328 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
drop table if exists "trial"."public"."merger_model__dbt_backup" cascade
00:16:11.537261 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
00:16:11.538415 [debug] [Thread-1  ]: finished collecting timing info
00:16:11.538600 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:16:11.539044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba651f5-1f35-4cef-89de-b6ce3b2ce83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e4659eb0>]}
00:16:11.539366 [info ] [Thread-1  ]: 1 of 4 OK created table model public.merger_model .............................. [[32mSELECT 422791[0m in 8.18s]
00:16:11.539752 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:16:11.540470 [debug] [Thread-1  ]: Began running node model.ad.cleaner_model
00:16:11.540718 [info ] [Thread-1  ]: 2 of 4 START table model public.cleaner_model .................................. [RUN]
00:16:11.541254 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.cleaner_model"
00:16:11.541446 [debug] [Thread-1  ]: Began compiling node model.ad.cleaner_model
00:16:11.541673 [debug] [Thread-1  ]: Compiling model.ad.cleaner_model
00:16:11.544815 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.cleaner_model"
00:16:11.545334 [debug] [Thread-1  ]: finished collecting timing info
00:16:11.545644 [debug] [Thread-1  ]: Began executing node model.ad.cleaner_model
00:16:11.549466 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.cleaner_model"
00:16:11.549900 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:16:11.550142 [debug] [Thread-1  ]: On model.ad.cleaner_model: BEGIN
00:16:11.550326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:16:11.562612 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:16:11.562854 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:16:11.562990 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */


  create  table "trial"."public"."cleaner_model__dbt_tmp"
  as (
    
select *
from "trial"."public"."merger_model"
where row_num = 1
  );
00:16:17.950839 [debug] [Thread-1  ]: SQL status: SELECT 422387 in 6.39 seconds
00:16:17.953349 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:16:17.953863 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
alter table "trial"."public"."cleaner_model" rename to "cleaner_model__dbt_backup"
00:16:18.955082 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 1.0 seconds
00:16:18.959139 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:16:18.959580 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
alter table "trial"."public"."cleaner_model__dbt_tmp" rename to "cleaner_model"
00:16:18.960567 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:16:18.962385 [debug] [Thread-1  ]: On model.ad.cleaner_model: COMMIT
00:16:18.962599 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:16:18.962755 [debug] [Thread-1  ]: On model.ad.cleaner_model: COMMIT
00:16:18.964365 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:16:18.967932 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:16:18.968298 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
drop table if exists "trial"."public"."cleaner_model__dbt_backup" cascade
00:16:20.005976 [debug] [Thread-1  ]: SQL status: DROP TABLE in 1.04 seconds
00:16:20.007530 [debug] [Thread-1  ]: finished collecting timing info
00:16:20.007785 [debug] [Thread-1  ]: On model.ad.cleaner_model: Close
00:16:20.008508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba651f5-1f35-4cef-89de-b6ce3b2ce83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e456b5b0>]}
00:16:20.009265 [info ] [Thread-1  ]: 2 of 4 OK created table model public.cleaner_model ............................. [[32mSELECT 422387[0m in 8.47s]
00:16:20.009778 [debug] [Thread-1  ]: Finished running node model.ad.cleaner_model
00:16:20.010529 [debug] [Thread-1  ]: Began running node model.ad.group_by_country
00:16:20.010843 [info ] [Thread-1  ]: 3 of 4 START view model public.group_by_country ................................ [RUN]
00:16:20.011411 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.group_by_country"
00:16:20.011686 [debug] [Thread-1  ]: Began compiling node model.ad.group_by_country
00:16:20.011954 [debug] [Thread-1  ]: Compiling model.ad.group_by_country
00:16:20.015007 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.group_by_country"
00:16:20.015398 [debug] [Thread-1  ]: finished collecting timing info
00:16:20.015579 [debug] [Thread-1  ]: Began executing node model.ad.group_by_country
00:16:20.031882 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.group_by_country"
00:16:20.032414 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:16:20.032633 [debug] [Thread-1  ]: On model.ad.group_by_country: BEGIN
00:16:20.032784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:16:20.042053 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:16:20.042398 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:16:20.042539 [debug] [Thread-1  ]: On model.ad.group_by_country: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_country"} */

  create view "trial"."public"."group_by_country__dbt_tmp" as (
    

select * , count("type")
from "trial"."public"."cleaner_model"
group by "geo_country"
  );
00:16:20.044833 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 6: select * , count("type")
               ^

00:16:20.045031 [debug] [Thread-1  ]: On model.ad.group_by_country: ROLLBACK
00:16:20.045386 [debug] [Thread-1  ]: finished collecting timing info
00:16:20.045560 [debug] [Thread-1  ]: On model.ad.group_by_country: Close
00:16:20.046029 [debug] [Thread-1  ]: Database Error in model group_by_country (models/advert/group_by_country.sql)
  column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6: select * , count("type")
                 ^
  compiled SQL at target/run/ad/models/advert/group_by_country.sql
00:16:20.046635 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba651f5-1f35-4cef-89de-b6ce3b2ce83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e4616e20>]}
00:16:20.047050 [error] [Thread-1  ]: 3 of 4 ERROR creating view model public.group_by_country ....................... [[31mERROR[0m in 0.04s]
00:16:20.047554 [debug] [Thread-1  ]: Finished running node model.ad.group_by_country
00:16:20.047815 [debug] [Thread-1  ]: Began running node model.ad.group_by_sitename
00:16:20.048415 [info ] [Thread-1  ]: 4 of 4 START view model public.group_by_sitename ............................... [RUN]
00:16:20.049079 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.group_by_sitename"
00:16:20.049329 [debug] [Thread-1  ]: Began compiling node model.ad.group_by_sitename
00:16:20.049478 [debug] [Thread-1  ]: Compiling model.ad.group_by_sitename
00:16:20.051609 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.group_by_sitename"
00:16:20.051894 [debug] [Thread-1  ]: finished collecting timing info
00:16:20.052040 [debug] [Thread-1  ]: Began executing node model.ad.group_by_sitename
00:16:20.054783 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.group_by_sitename"
00:16:20.055205 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:16:20.055373 [debug] [Thread-1  ]: On model.ad.group_by_sitename: BEGIN
00:16:20.055512 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:16:20.062735 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:16:20.062965 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:16:20.063098 [debug] [Thread-1  ]: On model.ad.group_by_sitename: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_sitename"} */

  create view "trial"."public"."group_by_sitename__dbt_tmp" as (
    

select * , count("type")
from "trial"."public"."cleaner_model"
group by "site_name"
  );
00:16:20.064158 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 6: select * , count("type")
               ^

00:16:20.064391 [debug] [Thread-1  ]: On model.ad.group_by_sitename: ROLLBACK
00:16:20.064771 [debug] [Thread-1  ]: finished collecting timing info
00:16:20.065105 [debug] [Thread-1  ]: On model.ad.group_by_sitename: Close
00:16:20.065802 [debug] [Thread-1  ]: Database Error in model group_by_sitename (models/advert/group_by_sitename.sql)
  column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6: select * , count("type")
                 ^
  compiled SQL at target/run/ad/models/advert/group_by_sitename.sql
00:16:20.066146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba651f5-1f35-4cef-89de-b6ce3b2ce83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e4655e50>]}
00:16:20.066485 [error] [Thread-1  ]: 4 of 4 ERROR creating view model public.group_by_sitename ...................... [[31mERROR[0m in 0.02s]
00:16:20.066884 [debug] [Thread-1  ]: Finished running node model.ad.group_by_sitename
00:16:20.067885 [debug] [MainThread]: Acquiring new postgres connection "master"
00:16:20.068166 [debug] [MainThread]: Using postgres connection "master"
00:16:20.068324 [debug] [MainThread]: On master: BEGIN
00:16:20.068464 [debug] [MainThread]: Opening a new connection, currently in state closed
00:16:20.076309 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:16:20.076575 [debug] [MainThread]: On master: COMMIT
00:16:20.076729 [debug] [MainThread]: Using postgres connection "master"
00:16:20.076875 [debug] [MainThread]: On master: COMMIT
00:16:20.077105 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:16:20.077437 [debug] [MainThread]: On master: Close
00:16:20.077929 [info ] [MainThread]: 
00:16:20.078236 [info ] [MainThread]: Finished running 2 table models, 2 view models in 16.80s.
00:16:20.078512 [debug] [MainThread]: Connection 'master' was properly closed.
00:16:20.078710 [debug] [MainThread]: Connection 'model.ad.group_by_sitename' was properly closed.
00:16:20.082587 [info ] [MainThread]: 
00:16:20.082953 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
00:16:20.083276 [info ] [MainThread]: 
00:16:20.083546 [error] [MainThread]: [33mDatabase Error in model group_by_country (models/advert/group_by_country.sql)[0m
00:16:20.083834 [error] [MainThread]:   column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
00:16:20.084107 [error] [MainThread]:   LINE 6: select * , count("type")
00:16:20.084376 [error] [MainThread]:                  ^
00:16:20.084645 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/group_by_country.sql
00:16:20.084919 [info ] [MainThread]: 
00:16:20.085211 [error] [MainThread]: [33mDatabase Error in model group_by_sitename (models/advert/group_by_sitename.sql)[0m
00:16:20.085517 [error] [MainThread]:   column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
00:16:20.085832 [error] [MainThread]:   LINE 6: select * , count("type")
00:16:20.086088 [error] [MainThread]:                  ^
00:16:20.086335 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/group_by_sitename.sql
00:16:20.086606 [info ] [MainThread]: 
00:16:20.086875 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
00:16:20.087226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e46480a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e4648100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e5f00e80>]}


============================== 2022-08-10 00:18:24.682806 | eefa5364-8bf3-47c6-be97-d8f1104b7d8d ==============================
00:18:24.682821 [info ] [MainThread]: Running with dbt=1.1.1
00:18:24.683285 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:18:24.683413 [debug] [MainThread]: Tracking: tracking
00:18:24.715077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242a174f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242a174fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242a18a0a0>]}
00:18:24.736578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:18:24.736934 [debug] [MainThread]: Partial parsing: updated file: ad://models/advert/group_by_sitename.sql
00:18:24.747781 [debug] [MainThread]: 1699: static parser successfully parsed advert/group_by_sitename.sql
00:18:24.761979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eefa5364-8bf3-47c6-be97-d8f1104b7d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242a09d970>]}
00:18:24.764882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eefa5364-8bf3-47c6-be97-d8f1104b7d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242a0becd0>]}
00:18:24.765142 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:18:24.765416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eefa5364-8bf3-47c6-be97-d8f1104b7d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242a1e0490>]}
00:18:24.766579 [info ] [MainThread]: 
00:18:24.767111 [debug] [MainThread]: Acquiring new postgres connection "master"
00:18:24.768117 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:18:24.775492 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:18:24.775645 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:18:24.775769 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:18:24.784849 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:18:24.786287 [debug] [ThreadPool]: On list_trial: Close
00:18:24.787729 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:18:24.792555 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:18:24.792820 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:18:24.792957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:18:24.800673 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:18:24.800946 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:18:24.801258 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:18:24.804968 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
00:18:24.806666 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:18:24.807090 [debug] [ThreadPool]: On list_trial_public: Close
00:18:24.811103 [debug] [MainThread]: Using postgres connection "master"
00:18:24.811373 [debug] [MainThread]: On master: BEGIN
00:18:24.811577 [debug] [MainThread]: Opening a new connection, currently in state init
00:18:24.819145 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:18:24.819445 [debug] [MainThread]: Using postgres connection "master"
00:18:24.819662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:18:24.837882 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:18:24.839539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eefa5364-8bf3-47c6-be97-d8f1104b7d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242a0bec40>]}
00:18:24.840121 [debug] [MainThread]: On master: ROLLBACK
00:18:24.840663 [debug] [MainThread]: Using postgres connection "master"
00:18:24.840911 [debug] [MainThread]: On master: BEGIN
00:18:24.841476 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:18:24.841676 [debug] [MainThread]: On master: COMMIT
00:18:24.841823 [debug] [MainThread]: Using postgres connection "master"
00:18:24.841953 [debug] [MainThread]: On master: COMMIT
00:18:24.842165 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:18:24.842318 [debug] [MainThread]: On master: Close
00:18:24.842781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:18:24.843050 [info ] [MainThread]: 
00:18:24.846824 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:18:24.847183 [info ] [Thread-1  ]: 1 of 4 START table model public.merger_model ................................... [RUN]
00:18:24.847934 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:18:24.848091 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:18:24.848226 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:18:24.850954 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:18:24.851513 [debug] [Thread-1  ]: finished collecting timing info
00:18:24.851854 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:18:24.875902 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:18:24.876319 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:24.876473 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:18:24.876589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:24.883249 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:18:24.883601 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:24.883721 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."public"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."public"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."public"."campaigns_inventory" left join "trial"."public"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:18:27.976420 [debug] [Thread-1  ]: SQL status: SELECT 422791 in 3.09 seconds
00:18:27.980921 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:27.981064 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model" rename to "merger_model__dbt_backup"
00:18:27.981885 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:18:27.983381 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:27.983496 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model__dbt_tmp" rename to "merger_model"
00:18:27.983985 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:18:27.990575 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:18:27.990706 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:27.990811 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:18:27.993467 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:18:27.996513 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:27.996628 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
drop table if exists "trial"."public"."merger_model__dbt_backup" cascade
00:18:28.050083 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.05 seconds
00:18:28.051537 [debug] [Thread-1  ]: finished collecting timing info
00:18:28.051747 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:18:28.052277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eefa5364-8bf3-47c6-be97-d8f1104b7d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242a094460>]}
00:18:28.052628 [info ] [Thread-1  ]: 1 of 4 OK created table model public.merger_model .............................. [[32mSELECT 422791[0m in 3.20s]
00:18:28.053026 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:18:28.053789 [debug] [Thread-1  ]: Began running node model.ad.cleaner_model
00:18:28.054123 [info ] [Thread-1  ]: 2 of 4 START table model public.cleaner_model .................................. [RUN]
00:18:28.054675 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.cleaner_model"
00:18:28.054832 [debug] [Thread-1  ]: Began compiling node model.ad.cleaner_model
00:18:28.055010 [debug] [Thread-1  ]: Compiling model.ad.cleaner_model
00:18:28.057286 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.cleaner_model"
00:18:28.057613 [debug] [Thread-1  ]: finished collecting timing info
00:18:28.057789 [debug] [Thread-1  ]: Began executing node model.ad.cleaner_model
00:18:28.060062 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.cleaner_model"
00:18:28.060372 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:28.060507 [debug] [Thread-1  ]: On model.ad.cleaner_model: BEGIN
00:18:28.060619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:28.072851 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:18:28.073283 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:28.073555 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */


  create  table "trial"."public"."cleaner_model__dbt_tmp"
  as (
    
select *
from "trial"."public"."merger_model"
where row_num = 1
  );
00:18:31.385233 [debug] [Thread-1  ]: SQL status: SELECT 422387 in 3.31 seconds
00:18:31.387193 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:31.387340 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
alter table "trial"."public"."cleaner_model" rename to "cleaner_model__dbt_backup"
00:18:31.387783 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:18:31.389316 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:31.389448 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
alter table "trial"."public"."cleaner_model__dbt_tmp" rename to "cleaner_model"
00:18:31.389752 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:18:31.390883 [debug] [Thread-1  ]: On model.ad.cleaner_model: COMMIT
00:18:31.390998 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:31.391094 [debug] [Thread-1  ]: On model.ad.cleaner_model: COMMIT
00:18:31.392744 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:18:31.394642 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:31.394755 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
drop table if exists "trial"."public"."cleaner_model__dbt_backup" cascade
00:18:31.429196 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
00:18:31.430150 [debug] [Thread-1  ]: finished collecting timing info
00:18:31.430358 [debug] [Thread-1  ]: On model.ad.cleaner_model: Close
00:18:31.430958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eefa5364-8bf3-47c6-be97-d8f1104b7d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2429052610>]}
00:18:31.431407 [info ] [Thread-1  ]: 2 of 4 OK created table model public.cleaner_model ............................. [[32mSELECT 422387[0m in 3.38s]
00:18:31.431958 [debug] [Thread-1  ]: Finished running node model.ad.cleaner_model
00:18:31.432882 [debug] [Thread-1  ]: Began running node model.ad.group_by_country
00:18:31.433326 [info ] [Thread-1  ]: 3 of 4 START view model public.group_by_country ................................ [RUN]
00:18:31.434047 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.group_by_country"
00:18:31.434262 [debug] [Thread-1  ]: Began compiling node model.ad.group_by_country
00:18:31.434413 [debug] [Thread-1  ]: Compiling model.ad.group_by_country
00:18:31.436683 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.group_by_country"
00:18:31.437030 [debug] [Thread-1  ]: finished collecting timing info
00:18:31.437207 [debug] [Thread-1  ]: Began executing node model.ad.group_by_country
00:18:31.453831 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.group_by_country"
00:18:31.454314 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:18:31.454489 [debug] [Thread-1  ]: On model.ad.group_by_country: BEGIN
00:18:31.454649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:31.464096 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:18:31.464403 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:18:31.464922 [debug] [Thread-1  ]: On model.ad.group_by_country: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_country"} */

  create view "trial"."public"."group_by_country__dbt_tmp" as (
    

select * , count("type")
from "trial"."public"."cleaner_model"
group by "geo_country"
  );
00:18:31.466469 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 6: select * , count("type")
               ^

00:18:31.466734 [debug] [Thread-1  ]: On model.ad.group_by_country: ROLLBACK
00:18:31.467250 [debug] [Thread-1  ]: finished collecting timing info
00:18:31.467466 [debug] [Thread-1  ]: On model.ad.group_by_country: Close
00:18:31.468139 [debug] [Thread-1  ]: Database Error in model group_by_country (models/advert/group_by_country.sql)
  column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6: select * , count("type")
                 ^
  compiled SQL at target/run/ad/models/advert/group_by_country.sql
00:18:31.468467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eefa5364-8bf3-47c6-be97-d8f1104b7d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242880d670>]}
00:18:31.468821 [error] [Thread-1  ]: 3 of 4 ERROR creating view model public.group_by_country ....................... [[31mERROR[0m in 0.03s]
00:18:31.469270 [debug] [Thread-1  ]: Finished running node model.ad.group_by_country
00:18:31.469466 [debug] [Thread-1  ]: Began running node model.ad.group_by_sitename
00:18:31.469826 [info ] [Thread-1  ]: 4 of 4 START view model public.group_by_sitename ............................... [RUN]
00:18:31.470344 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.group_by_sitename"
00:18:31.470521 [debug] [Thread-1  ]: Began compiling node model.ad.group_by_sitename
00:18:31.470665 [debug] [Thread-1  ]: Compiling model.ad.group_by_sitename
00:18:31.473369 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.group_by_sitename"
00:18:31.473680 [debug] [Thread-1  ]: finished collecting timing info
00:18:31.473847 [debug] [Thread-1  ]: Began executing node model.ad.group_by_sitename
00:18:31.475876 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.group_by_sitename"
00:18:31.476332 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:18:31.476501 [debug] [Thread-1  ]: On model.ad.group_by_sitename: BEGIN
00:18:31.476640 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:31.484899 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:18:31.485265 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:18:31.485499 [debug] [Thread-1  ]: On model.ad.group_by_sitename: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_sitename"} */

  create view "trial"."public"."group_by_sitename__dbt_tmp" as (
    

select * , "campaign_id" , count("type")
from "trial"."public"."cleaner_model"
group by "site_name"
  );
00:18:31.486311 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 6: select * , "campaign_id" , count("type")
               ^

00:18:31.486550 [debug] [Thread-1  ]: On model.ad.group_by_sitename: ROLLBACK
00:18:31.486914 [debug] [Thread-1  ]: finished collecting timing info
00:18:31.487105 [debug] [Thread-1  ]: On model.ad.group_by_sitename: Close
00:18:31.487952 [debug] [Thread-1  ]: Database Error in model group_by_sitename (models/advert/group_by_sitename.sql)
  column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6: select * , "campaign_id" , count("type")
                 ^
  compiled SQL at target/run/ad/models/advert/group_by_sitename.sql
00:18:31.488477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eefa5364-8bf3-47c6-be97-d8f1104b7d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2428784b80>]}
00:18:31.489035 [error] [Thread-1  ]: 4 of 4 ERROR creating view model public.group_by_sitename ...................... [[31mERROR[0m in 0.02s]
00:18:31.489510 [debug] [Thread-1  ]: Finished running node model.ad.group_by_sitename
00:18:31.490589 [debug] [MainThread]: Acquiring new postgres connection "master"
00:18:31.490855 [debug] [MainThread]: Using postgres connection "master"
00:18:31.491046 [debug] [MainThread]: On master: BEGIN
00:18:31.491216 [debug] [MainThread]: Opening a new connection, currently in state closed
00:18:31.499424 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:18:31.499757 [debug] [MainThread]: On master: COMMIT
00:18:31.499910 [debug] [MainThread]: Using postgres connection "master"
00:18:31.500048 [debug] [MainThread]: On master: COMMIT
00:18:31.500291 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:18:31.500490 [debug] [MainThread]: On master: Close
00:18:31.501323 [info ] [MainThread]: 
00:18:31.501858 [info ] [MainThread]: Finished running 2 table models, 2 view models in 6.73s.
00:18:31.502267 [debug] [MainThread]: Connection 'master' was properly closed.
00:18:31.502795 [debug] [MainThread]: Connection 'model.ad.group_by_sitename' was properly closed.
00:18:31.506555 [info ] [MainThread]: 
00:18:31.506854 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
00:18:31.507131 [info ] [MainThread]: 
00:18:31.507370 [error] [MainThread]: [33mDatabase Error in model group_by_country (models/advert/group_by_country.sql)[0m
00:18:31.507599 [error] [MainThread]:   column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
00:18:31.507820 [error] [MainThread]:   LINE 6: select * , count("type")
00:18:31.508048 [error] [MainThread]:                  ^
00:18:31.508274 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/group_by_country.sql
00:18:31.508575 [info ] [MainThread]: 
00:18:31.508857 [error] [MainThread]: [33mDatabase Error in model group_by_sitename (models/advert/group_by_sitename.sql)[0m
00:18:31.509285 [error] [MainThread]:   column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
00:18:31.509856 [error] [MainThread]:   LINE 6: select * , "campaign_id" , count("type")
00:18:31.510147 [error] [MainThread]:                  ^
00:18:31.510432 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/group_by_sitename.sql
00:18:31.510732 [info ] [MainThread]: 
00:18:31.511011 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
00:18:31.511362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242a0bee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242a1e04c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242a1e0490>]}


============================== 2022-08-10 00:18:47.962107 | 06267129-df9d-47dd-ad60-329301c99b34 ==============================
00:18:47.962123 [info ] [MainThread]: Running with dbt=1.1.1
00:18:47.962683 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:18:47.962826 [debug] [MainThread]: Tracking: tracking
00:18:47.983800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce244ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce244ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce24690a0>]}
00:18:48.007785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:18:48.008135 [debug] [MainThread]: Partial parsing: updated file: ad://models/advert/group_by_sitename.sql
00:18:48.019261 [debug] [MainThread]: 1699: static parser successfully parsed advert/group_by_sitename.sql
00:18:48.033405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06267129-df9d-47dd-ad60-329301c99b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce237f970>]}
00:18:48.036576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06267129-df9d-47dd-ad60-329301c99b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce23a2cd0>]}
00:18:48.036830 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:18:48.037077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06267129-df9d-47dd-ad60-329301c99b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce24c3490>]}
00:18:48.038248 [info ] [MainThread]: 
00:18:48.038699 [debug] [MainThread]: Acquiring new postgres connection "master"
00:18:48.039560 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:18:48.047474 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:18:48.047763 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:18:48.048006 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:18:48.058736 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:18:48.060101 [debug] [ThreadPool]: On list_trial: Close
00:18:48.061778 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:18:48.067647 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:18:48.067851 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:18:48.067988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:18:48.075580 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:18:48.075794 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:18:48.075925 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:18:48.078540 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
00:18:48.079838 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:18:48.080307 [debug] [ThreadPool]: On list_trial_public: Close
00:18:48.085597 [debug] [MainThread]: Using postgres connection "master"
00:18:48.085834 [debug] [MainThread]: On master: BEGIN
00:18:48.085968 [debug] [MainThread]: Opening a new connection, currently in state init
00:18:48.094587 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:18:48.094820 [debug] [MainThread]: Using postgres connection "master"
00:18:48.094963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:18:48.113450 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:18:48.114825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06267129-df9d-47dd-ad60-329301c99b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce23a2bb0>]}
00:18:48.115096 [debug] [MainThread]: On master: ROLLBACK
00:18:48.115382 [debug] [MainThread]: Using postgres connection "master"
00:18:48.115534 [debug] [MainThread]: On master: BEGIN
00:18:48.115993 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:18:48.116174 [debug] [MainThread]: On master: COMMIT
00:18:48.116316 [debug] [MainThread]: Using postgres connection "master"
00:18:48.116447 [debug] [MainThread]: On master: COMMIT
00:18:48.116628 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:18:48.116769 [debug] [MainThread]: On master: Close
00:18:48.117219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:18:48.117493 [info ] [MainThread]: 
00:18:48.120146 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:18:48.120460 [info ] [Thread-1  ]: 1 of 4 START table model public.merger_model ................................... [RUN]
00:18:48.120937 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:18:48.121130 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:18:48.121300 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:18:48.123993 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:18:48.124340 [debug] [Thread-1  ]: finished collecting timing info
00:18:48.124536 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:18:48.147251 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:18:48.147731 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:48.147911 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:18:48.148036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:48.155738 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:18:48.155937 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:48.156065 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."public"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."public"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."public"."campaigns_inventory" left join "trial"."public"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:18:51.570074 [debug] [Thread-1  ]: SQL status: SELECT 422791 in 3.41 seconds
00:18:51.574453 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:51.574596 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model" rename to "merger_model__dbt_backup"
00:18:51.575303 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:18:51.576757 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:51.576869 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model__dbt_tmp" rename to "merger_model"
00:18:51.577531 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:18:51.584075 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:18:51.584192 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:51.584280 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:18:51.587092 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:18:51.590272 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:18:51.590398 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
drop table if exists "trial"."public"."merger_model__dbt_backup" cascade
00:18:51.602651 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
00:18:51.603762 [debug] [Thread-1  ]: finished collecting timing info
00:18:51.603939 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:18:51.604413 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06267129-df9d-47dd-ad60-329301c99b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce23791f0>]}
00:18:51.604734 [info ] [Thread-1  ]: 1 of 4 OK created table model public.merger_model .............................. [[32mSELECT 422791[0m in 3.48s]
00:18:51.605171 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:18:51.606120 [debug] [Thread-1  ]: Began running node model.ad.cleaner_model
00:18:51.606501 [info ] [Thread-1  ]: 2 of 4 START table model public.cleaner_model .................................. [RUN]
00:18:51.607029 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.cleaner_model"
00:18:51.607205 [debug] [Thread-1  ]: Began compiling node model.ad.cleaner_model
00:18:51.607422 [debug] [Thread-1  ]: Compiling model.ad.cleaner_model
00:18:51.609582 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.cleaner_model"
00:18:51.609918 [debug] [Thread-1  ]: finished collecting timing info
00:18:51.610074 [debug] [Thread-1  ]: Began executing node model.ad.cleaner_model
00:18:51.612308 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.cleaner_model"
00:18:51.612595 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:51.612733 [debug] [Thread-1  ]: On model.ad.cleaner_model: BEGIN
00:18:51.612849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:51.621201 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:18:51.621522 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:51.621683 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */


  create  table "trial"."public"."cleaner_model__dbt_tmp"
  as (
    
select *
from "trial"."public"."merger_model"
where row_num = 1
  );
00:18:55.038147 [debug] [Thread-1  ]: SQL status: SELECT 422387 in 3.42 seconds
00:18:55.040472 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:55.040632 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
alter table "trial"."public"."cleaner_model" rename to "cleaner_model__dbt_backup"
00:18:55.044196 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:18:55.046046 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:55.046181 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
alter table "trial"."public"."cleaner_model__dbt_tmp" rename to "cleaner_model"
00:18:55.046622 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:18:55.047802 [debug] [Thread-1  ]: On model.ad.cleaner_model: COMMIT
00:18:55.047930 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:55.048028 [debug] [Thread-1  ]: On model.ad.cleaner_model: COMMIT
00:18:55.049428 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:18:55.051289 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:18:55.051407 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
drop table if exists "trial"."public"."cleaner_model__dbt_backup" cascade
00:18:55.076462 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
00:18:55.077530 [debug] [Thread-1  ]: finished collecting timing info
00:18:55.077729 [debug] [Thread-1  ]: On model.ad.cleaner_model: Close
00:18:55.078206 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06267129-df9d-47dd-ad60-329301c99b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce1533610>]}
00:18:55.078494 [info ] [Thread-1  ]: 2 of 4 OK created table model public.cleaner_model ............................. [[32mSELECT 422387[0m in 3.47s]
00:18:55.078829 [debug] [Thread-1  ]: Finished running node model.ad.cleaner_model
00:18:55.079447 [debug] [Thread-1  ]: Began running node model.ad.group_by_country
00:18:55.079736 [info ] [Thread-1  ]: 3 of 4 START view model public.group_by_country ................................ [RUN]
00:18:55.080213 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.group_by_country"
00:18:55.080359 [debug] [Thread-1  ]: Began compiling node model.ad.group_by_country
00:18:55.080507 [debug] [Thread-1  ]: Compiling model.ad.group_by_country
00:18:55.082845 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.group_by_country"
00:18:55.083226 [debug] [Thread-1  ]: finished collecting timing info
00:18:55.083412 [debug] [Thread-1  ]: Began executing node model.ad.group_by_country
00:18:55.099772 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.group_by_country"
00:18:55.100204 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:18:55.100366 [debug] [Thread-1  ]: On model.ad.group_by_country: BEGIN
00:18:55.100490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:55.110805 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:18:55.111387 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:18:55.111530 [debug] [Thread-1  ]: On model.ad.group_by_country: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_country"} */

  create view "trial"."public"."group_by_country__dbt_tmp" as (
    

select * , count("type")
from "trial"."public"."cleaner_model"
group by "geo_country"
  );
00:18:55.115077 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 6: select * , count("type")
               ^

00:18:55.115414 [debug] [Thread-1  ]: On model.ad.group_by_country: ROLLBACK
00:18:55.115731 [debug] [Thread-1  ]: finished collecting timing info
00:18:55.115878 [debug] [Thread-1  ]: On model.ad.group_by_country: Close
00:18:55.116291 [debug] [Thread-1  ]: Database Error in model group_by_country (models/advert/group_by_country.sql)
  column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6: select * , count("type")
                 ^
  compiled SQL at target/run/ad/models/advert/group_by_country.sql
00:18:55.116550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06267129-df9d-47dd-ad60-329301c99b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce04baf40>]}
00:18:55.116871 [error] [Thread-1  ]: 3 of 4 ERROR creating view model public.group_by_country ....................... [[31mERROR[0m in 0.04s]
00:18:55.117304 [debug] [Thread-1  ]: Finished running node model.ad.group_by_country
00:18:55.117509 [debug] [Thread-1  ]: Began running node model.ad.group_by_sitename
00:18:55.117922 [info ] [Thread-1  ]: 4 of 4 START view model public.group_by_sitename ............................... [RUN]
00:18:55.118432 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.group_by_sitename"
00:18:55.118643 [debug] [Thread-1  ]: Began compiling node model.ad.group_by_sitename
00:18:55.118785 [debug] [Thread-1  ]: Compiling model.ad.group_by_sitename
00:18:55.120760 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.group_by_sitename"
00:18:55.121004 [debug] [Thread-1  ]: finished collecting timing info
00:18:55.121216 [debug] [Thread-1  ]: Began executing node model.ad.group_by_sitename
00:18:55.123374 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.group_by_sitename"
00:18:55.123629 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:18:55.123771 [debug] [Thread-1  ]: On model.ad.group_by_sitename: BEGIN
00:18:55.123895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:18:55.131767 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:18:55.132077 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:18:55.132208 [debug] [Thread-1  ]: On model.ad.group_by_sitename: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_sitename"} */

  create view "trial"."public"."group_by_sitename__dbt_tmp" as (
    

select "site_name" , count("type")
from "trial"."public"."cleaner_model"
group by "site_name"
  );
00:18:55.137431 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
00:18:55.139342 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:18:55.139491 [debug] [Thread-1  ]: On model.ad.group_by_sitename: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_sitename"} */
alter table "trial"."public"."group_by_sitename__dbt_tmp" rename to "group_by_sitename"
00:18:55.139850 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:18:55.140825 [debug] [Thread-1  ]: On model.ad.group_by_sitename: COMMIT
00:18:55.140974 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:18:55.141098 [debug] [Thread-1  ]: On model.ad.group_by_sitename: COMMIT
00:18:55.143330 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:18:55.146243 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:18:55.146551 [debug] [Thread-1  ]: On model.ad.group_by_sitename: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_sitename"} */
drop view if exists "trial"."public"."group_by_sitename__dbt_backup" cascade
00:18:55.147077 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:18:55.148650 [debug] [Thread-1  ]: finished collecting timing info
00:18:55.148925 [debug] [Thread-1  ]: On model.ad.group_by_sitename: Close
00:18:55.149818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06267129-df9d-47dd-ad60-329301c99b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce0cdffd0>]}
00:18:55.150327 [info ] [Thread-1  ]: 4 of 4 OK created view model public.group_by_sitename .......................... [[32mCREATE VIEW[0m in 0.03s]
00:18:55.150909 [debug] [Thread-1  ]: Finished running node model.ad.group_by_sitename
00:18:55.151910 [debug] [MainThread]: Acquiring new postgres connection "master"
00:18:55.152118 [debug] [MainThread]: Using postgres connection "master"
00:18:55.152261 [debug] [MainThread]: On master: BEGIN
00:18:55.152393 [debug] [MainThread]: Opening a new connection, currently in state closed
00:18:55.159375 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:18:55.159621 [debug] [MainThread]: On master: COMMIT
00:18:55.159749 [debug] [MainThread]: Using postgres connection "master"
00:18:55.159866 [debug] [MainThread]: On master: COMMIT
00:18:55.160040 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:18:55.160178 [debug] [MainThread]: On master: Close
00:18:55.160619 [info ] [MainThread]: 
00:18:55.160883 [info ] [MainThread]: Finished running 2 table models, 2 view models in 7.12s.
00:18:55.161475 [debug] [MainThread]: Connection 'master' was properly closed.
00:18:55.161721 [debug] [MainThread]: Connection 'model.ad.group_by_sitename' was properly closed.
00:18:55.166220 [info ] [MainThread]: 
00:18:55.166556 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:18:55.166849 [info ] [MainThread]: 
00:18:55.167107 [error] [MainThread]: [33mDatabase Error in model group_by_country (models/advert/group_by_country.sql)[0m
00:18:55.167372 [error] [MainThread]:   column "cleaner_model.campaign_id" must appear in the GROUP BY clause or be used in an aggregate function
00:18:55.167642 [error] [MainThread]:   LINE 6: select * , count("type")
00:18:55.167896 [error] [MainThread]:                  ^
00:18:55.168147 [error] [MainThread]:   compiled SQL at target/run/ad/models/advert/group_by_country.sql
00:18:55.168413 [info ] [MainThread]: 
00:18:55.168661 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
00:18:55.168993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce04071c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce0ccd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ce24c34c0>]}


============================== 2022-08-10 00:19:09.657809 | 7423cc58-c89c-4e67-a5ad-124d8e0fccaf ==============================
00:19:09.657827 [info ] [MainThread]: Running with dbt=1.1.1
00:19:09.658353 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:19:09.658491 [debug] [MainThread]: Tracking: tracking
00:19:09.678851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d8e2ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d8e2ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d8e4a070>]}
00:19:09.701977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:19:09.702358 [debug] [MainThread]: Partial parsing: updated file: ad://models/advert/group_by_country.sql
00:19:09.712406 [debug] [MainThread]: 1699: static parser successfully parsed advert/group_by_country.sql
00:19:09.726257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7423cc58-c89c-4e67-a5ad-124d8e0fccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d8d9d940>]}
00:19:09.729188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7423cc58-c89c-4e67-a5ad-124d8e0fccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d8dc0dc0>]}
00:19:09.729466 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
00:19:09.729709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7423cc58-c89c-4e67-a5ad-124d8e0fccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d8dc03a0>]}
00:19:09.730884 [info ] [MainThread]: 
00:19:09.731313 [debug] [MainThread]: Acquiring new postgres connection "master"
00:19:09.732271 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
00:19:09.742322 [debug] [ThreadPool]: Using postgres connection "list_trial"
00:19:09.742563 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
00:19:09.742703 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:19:09.753725 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.01 seconds
00:19:09.755175 [debug] [ThreadPool]: On list_trial: Close
00:19:09.756786 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_public"
00:19:09.762182 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:19:09.762317 [debug] [ThreadPool]: On list_trial_public: BEGIN
00:19:09.762415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:19:09.769953 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:19:09.770179 [debug] [ThreadPool]: Using postgres connection "list_trial_public"
00:19:09.770321 [debug] [ThreadPool]: On list_trial_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "list_trial_public"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:19:09.772358 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
00:19:09.773515 [debug] [ThreadPool]: On list_trial_public: ROLLBACK
00:19:09.773849 [debug] [ThreadPool]: On list_trial_public: Close
00:19:09.777386 [debug] [MainThread]: Using postgres connection "master"
00:19:09.777539 [debug] [MainThread]: On master: BEGIN
00:19:09.777647 [debug] [MainThread]: Opening a new connection, currently in state init
00:19:09.784710 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:19:09.784942 [debug] [MainThread]: Using postgres connection "master"
00:19:09.785112 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:19:09.804817 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
00:19:09.806424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7423cc58-c89c-4e67-a5ad-124d8e0fccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d8dc0d30>]}
00:19:09.806888 [debug] [MainThread]: On master: ROLLBACK
00:19:09.807337 [debug] [MainThread]: Using postgres connection "master"
00:19:09.807496 [debug] [MainThread]: On master: BEGIN
00:19:09.807795 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:19:09.807943 [debug] [MainThread]: On master: COMMIT
00:19:09.808078 [debug] [MainThread]: Using postgres connection "master"
00:19:09.808204 [debug] [MainThread]: On master: COMMIT
00:19:09.808410 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:19:09.808557 [debug] [MainThread]: On master: Close
00:19:09.809010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:19:09.809315 [info ] [MainThread]: 
00:19:09.812068 [debug] [Thread-1  ]: Began running node model.ad.merger_model
00:19:09.812383 [info ] [Thread-1  ]: 1 of 4 START table model public.merger_model ................................... [RUN]
00:19:09.812953 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.merger_model"
00:19:09.813199 [debug] [Thread-1  ]: Began compiling node model.ad.merger_model
00:19:09.813381 [debug] [Thread-1  ]: Compiling model.ad.merger_model
00:19:09.816282 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.merger_model"
00:19:09.816713 [debug] [Thread-1  ]: finished collecting timing info
00:19:09.817240 [debug] [Thread-1  ]: Began executing node model.ad.merger_model
00:19:09.841458 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.merger_model"
00:19:09.841957 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:19:09.842142 [debug] [Thread-1  ]: On model.ad.merger_model: BEGIN
00:19:09.842281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:19:09.850181 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:19:09.850422 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:19:09.850578 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */


  create  table "trial"."public"."merger_model__dbt_tmp"
  as (
    

with tempbriefing as (
    SELECT 
       *,
        ROW_NUMBER() OVER (
            PARTITION BY 
               "campaign_id"
            ORDER BY 
               "campaign_id"
        ) "row_num"
     FROM 
        "trial"."public"."briefing"
        )

-- create table if not exists public.warehouse as 
SELECT * FROM "trial"."public"."campaigns_inventory" left join "trial"."public"."design" using ("game_key") left join tempbriefing using ("campaign_id")
  );
00:19:13.315903 [debug] [Thread-1  ]: SQL status: SELECT 422791 in 3.47 seconds
00:19:13.320761 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:19:13.320912 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model" rename to "merger_model__dbt_backup"
00:19:14.322993 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 1.0 seconds
00:19:14.325568 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:19:14.325716 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
alter table "trial"."public"."merger_model__dbt_tmp" rename to "merger_model"
00:19:14.326597 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:19:14.334322 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:19:14.334486 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:19:14.334605 [debug] [Thread-1  ]: On model.ad.merger_model: COMMIT
00:19:14.336356 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:19:14.340148 [debug] [Thread-1  ]: Using postgres connection "model.ad.merger_model"
00:19:14.340316 [debug] [Thread-1  ]: On model.ad.merger_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.merger_model"} */
drop table if exists "trial"."public"."merger_model__dbt_backup" cascade
00:19:14.373726 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
00:19:14.375121 [debug] [Thread-1  ]: finished collecting timing info
00:19:14.375339 [debug] [Thread-1  ]: On model.ad.merger_model: Close
00:19:14.375837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7423cc58-c89c-4e67-a5ad-124d8e0fccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d811ad00>]}
00:19:14.376204 [info ] [Thread-1  ]: 1 of 4 OK created table model public.merger_model .............................. [[32mSELECT 422791[0m in 4.56s]
00:19:14.376619 [debug] [Thread-1  ]: Finished running node model.ad.merger_model
00:19:14.377437 [debug] [Thread-1  ]: Began running node model.ad.cleaner_model
00:19:14.377816 [info ] [Thread-1  ]: 2 of 4 START table model public.cleaner_model .................................. [RUN]
00:19:14.378564 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.cleaner_model"
00:19:14.378812 [debug] [Thread-1  ]: Began compiling node model.ad.cleaner_model
00:19:14.379034 [debug] [Thread-1  ]: Compiling model.ad.cleaner_model
00:19:14.382099 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.cleaner_model"
00:19:14.382455 [debug] [Thread-1  ]: finished collecting timing info
00:19:14.382639 [debug] [Thread-1  ]: Began executing node model.ad.cleaner_model
00:19:14.385626 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.cleaner_model"
00:19:14.386094 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:19:14.386287 [debug] [Thread-1  ]: On model.ad.cleaner_model: BEGIN
00:19:14.386439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:19:14.395382 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:19:14.395669 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:19:14.395858 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */


  create  table "trial"."public"."cleaner_model__dbt_tmp"
  as (
    
select *
from "trial"."public"."merger_model"
where row_num = 1
  );
00:19:20.026782 [debug] [Thread-1  ]: SQL status: SELECT 422387 in 5.63 seconds
00:19:20.029049 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:19:20.029237 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
alter table "trial"."public"."cleaner_model" rename to "cleaner_model__dbt_backup"
00:19:21.031671 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 1.0 seconds
00:19:21.033746 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:19:21.033915 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
alter table "trial"."public"."cleaner_model__dbt_tmp" rename to "cleaner_model"
00:19:21.034390 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:19:21.035813 [debug] [Thread-1  ]: On model.ad.cleaner_model: COMMIT
00:19:21.035965 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:19:21.036088 [debug] [Thread-1  ]: On model.ad.cleaner_model: COMMIT
00:19:21.037564 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:19:21.039702 [debug] [Thread-1  ]: Using postgres connection "model.ad.cleaner_model"
00:19:21.039821 [debug] [Thread-1  ]: On model.ad.cleaner_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.cleaner_model"} */
drop table if exists "trial"."public"."cleaner_model__dbt_backup" cascade
00:19:21.072946 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
00:19:21.074180 [debug] [Thread-1  ]: finished collecting timing info
00:19:21.074411 [debug] [Thread-1  ]: On model.ad.cleaner_model: Close
00:19:21.074950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7423cc58-c89c-4e67-a5ad-124d8e0fccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d81556a0>]}
00:19:21.075296 [info ] [Thread-1  ]: 2 of 4 OK created table model public.cleaner_model ............................. [[32mSELECT 422387[0m in 6.70s]
00:19:21.075723 [debug] [Thread-1  ]: Finished running node model.ad.cleaner_model
00:19:21.076486 [debug] [Thread-1  ]: Began running node model.ad.group_by_country
00:19:21.076759 [info ] [Thread-1  ]: 3 of 4 START view model public.group_by_country ................................ [RUN]
00:19:21.077428 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.group_by_country"
00:19:21.077788 [debug] [Thread-1  ]: Began compiling node model.ad.group_by_country
00:19:21.077979 [debug] [Thread-1  ]: Compiling model.ad.group_by_country
00:19:21.080820 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.group_by_country"
00:19:21.081263 [debug] [Thread-1  ]: finished collecting timing info
00:19:21.081515 [debug] [Thread-1  ]: Began executing node model.ad.group_by_country
00:19:21.096717 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.group_by_country"
00:19:21.097356 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:19:21.097562 [debug] [Thread-1  ]: On model.ad.group_by_country: BEGIN
00:19:21.097713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:19:21.108006 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:19:21.108238 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:19:21.108370 [debug] [Thread-1  ]: On model.ad.group_by_country: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_country"} */

  create view "trial"."public"."group_by_country__dbt_tmp" as (
    

select "geo_country" , count("type")
from "trial"."public"."cleaner_model"
group by "geo_country"
  );
00:19:21.110200 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
00:19:21.112193 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:19:21.112594 [debug] [Thread-1  ]: On model.ad.group_by_country: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_country"} */
alter table "trial"."public"."group_by_country__dbt_tmp" rename to "group_by_country"
00:19:21.113272 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:19:21.115552 [debug] [Thread-1  ]: On model.ad.group_by_country: COMMIT
00:19:21.115836 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:19:21.116087 [debug] [Thread-1  ]: On model.ad.group_by_country: COMMIT
00:19:21.117560 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:19:21.120019 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_country"
00:19:21.120253 [debug] [Thread-1  ]: On model.ad.group_by_country: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_country"} */
drop view if exists "trial"."public"."group_by_country__dbt_backup" cascade
00:19:21.120899 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:19:21.121968 [debug] [Thread-1  ]: finished collecting timing info
00:19:21.122173 [debug] [Thread-1  ]: On model.ad.group_by_country: Close
00:19:21.122595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7423cc58-c89c-4e67-a5ad-124d8e0fccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d8d9dfa0>]}
00:19:21.122898 [info ] [Thread-1  ]: 3 of 4 OK created view model public.group_by_country ........................... [[32mCREATE VIEW[0m in 0.05s]
00:19:21.123282 [debug] [Thread-1  ]: Finished running node model.ad.group_by_country
00:19:21.123464 [debug] [Thread-1  ]: Began running node model.ad.group_by_sitename
00:19:21.123741 [info ] [Thread-1  ]: 4 of 4 START view model public.group_by_sitename ............................... [RUN]
00:19:21.124213 [debug] [Thread-1  ]: Acquiring new postgres connection "model.ad.group_by_sitename"
00:19:21.124433 [debug] [Thread-1  ]: Began compiling node model.ad.group_by_sitename
00:19:21.124589 [debug] [Thread-1  ]: Compiling model.ad.group_by_sitename
00:19:21.126651 [debug] [Thread-1  ]: Writing injected SQL for node "model.ad.group_by_sitename"
00:19:21.126953 [debug] [Thread-1  ]: finished collecting timing info
00:19:21.127092 [debug] [Thread-1  ]: Began executing node model.ad.group_by_sitename
00:19:21.129070 [debug] [Thread-1  ]: Writing runtime SQL for node "model.ad.group_by_sitename"
00:19:21.129670 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:19:21.129850 [debug] [Thread-1  ]: On model.ad.group_by_sitename: BEGIN
00:19:21.129998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:19:21.138271 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:19:21.138675 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:19:21.138865 [debug] [Thread-1  ]: On model.ad.group_by_sitename: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_sitename"} */

  create view "trial"."public"."group_by_sitename__dbt_tmp" as (
    

select "site_name" , count("type")
from "trial"."public"."cleaner_model"
group by "site_name"
  );
00:19:21.140361 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
00:19:21.142206 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:19:21.142351 [debug] [Thread-1  ]: On model.ad.group_by_sitename: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_sitename"} */
alter table "trial"."public"."group_by_sitename__dbt_tmp" rename to "group_by_sitename"
00:19:21.142968 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:19:21.143971 [debug] [Thread-1  ]: On model.ad.group_by_sitename: COMMIT
00:19:21.144100 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:19:21.144209 [debug] [Thread-1  ]: On model.ad.group_by_sitename: COMMIT
00:19:21.145340 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:19:21.147077 [debug] [Thread-1  ]: Using postgres connection "model.ad.group_by_sitename"
00:19:21.147261 [debug] [Thread-1  ]: On model.ad.group_by_sitename: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "ad", "target_name": "dev", "node_id": "model.ad.group_by_sitename"} */
drop view if exists "trial"."public"."group_by_sitename__dbt_backup" cascade
00:19:21.147634 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:19:21.148644 [debug] [Thread-1  ]: finished collecting timing info
00:19:21.148867 [debug] [Thread-1  ]: On model.ad.group_by_sitename: Close
00:19:21.149593 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7423cc58-c89c-4e67-a5ad-124d8e0fccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d8103fd0>]}
00:19:21.150105 [info ] [Thread-1  ]: 4 of 4 OK created view model public.group_by_sitename .......................... [[32mCREATE VIEW[0m in 0.03s]
00:19:21.150644 [debug] [Thread-1  ]: Finished running node model.ad.group_by_sitename
00:19:21.151577 [debug] [MainThread]: Acquiring new postgres connection "master"
00:19:21.151797 [debug] [MainThread]: Using postgres connection "master"
00:19:21.151935 [debug] [MainThread]: On master: BEGIN
00:19:21.152051 [debug] [MainThread]: Opening a new connection, currently in state closed
00:19:21.159774 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:19:21.159983 [debug] [MainThread]: On master: COMMIT
00:19:21.160105 [debug] [MainThread]: Using postgres connection "master"
00:19:21.160231 [debug] [MainThread]: On master: COMMIT
00:19:21.160435 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:19:21.160573 [debug] [MainThread]: On master: Close
00:19:21.160988 [info ] [MainThread]: 
00:19:21.161277 [info ] [MainThread]: Finished running 2 table models, 2 view models in 11.43s.
00:19:21.161531 [debug] [MainThread]: Connection 'master' was properly closed.
00:19:21.161655 [debug] [MainThread]: Connection 'model.ad.group_by_sitename' was properly closed.
00:19:21.165042 [info ] [MainThread]: 
00:19:21.165671 [info ] [MainThread]: [32mCompleted successfully[0m
00:19:21.165979 [info ] [MainThread]: 
00:19:21.166249 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
00:19:21.166569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d802f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d8dc0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d8dc0910>]}
